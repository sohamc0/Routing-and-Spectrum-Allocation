{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8816815256912222, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.85163824430076, "policy_loss": -0.01821854101013272, "vf_loss": 19.868628462924754, "vf_explained_var": 0.0003198825543926608, "kl": 0.006141408792134296, "entropy": 0.6868628317309964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 989.0, "episode_reward_min": 935.0, "episode_reward_mean": 957.075, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [937.0, 966.0, 942.0, 964.0, 969.0, 935.0, 983.0, 960.0, 961.0, 964.0, 944.0, 957.0, 941.0, 953.0, 989.0, 941.0, 946.0, 977.0, 953.0, 938.0, 970.0, 953.0, 970.0, 947.0, 952.0, 981.0, 963.0, 949.0, 954.0, 961.0, 940.0, 955.0, 965.0, 981.0, 950.0, 967.0, 940.0, 938.0, 957.0, 970.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3619909703627255, "mean_inference_ms": 1.7949311443043778, "mean_action_processing_ms": 0.1336052786615663, "mean_env_wait_ms": 0.12382797168749807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026178956031799316, "StateBufferConnector_ms": 0.005341768264770508, "ViewRequirementAgentConnector_ms": 0.13130903244018555}, "num_episodes": 40, "episode_return_max": 989.0, "episode_return_min": 935.0, "episode_return_mean": 957.075}, "env_runner_results": {"episode_reward_max": 989.0, "episode_reward_min": 935.0, "episode_reward_mean": 957.075, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [937.0, 966.0, 942.0, 964.0, 969.0, 935.0, 983.0, 960.0, 961.0, 964.0, 944.0, 957.0, 941.0, 953.0, 989.0, 941.0, 946.0, 977.0, 953.0, 938.0, 970.0, 953.0, 970.0, 947.0, 952.0, 981.0, 963.0, 949.0, 954.0, 961.0, 940.0, 955.0, 965.0, 981.0, 950.0, 967.0, 940.0, 938.0, 957.0, 970.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3619909703627255, "mean_inference_ms": 1.7949311443043778, "mean_action_processing_ms": 0.1336052786615663, "mean_env_wait_ms": 0.12382797168749807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026178956031799316, "StateBufferConnector_ms": 0.005341768264770508, "ViewRequirementAgentConnector_ms": 0.13130903244018555}, "num_episodes": 40, "episode_return_max": 989.0, "episode_return_min": 935.0, "episode_return_mean": 957.075}, "episode_reward_max": 989.0, "episode_reward_min": 935.0, "episode_reward_mean": 957.075, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [937.0, 966.0, 942.0, 964.0, 969.0, 935.0, 983.0, 960.0, 961.0, 964.0, 944.0, 957.0, 941.0, 953.0, 989.0, 941.0, 946.0, 977.0, 953.0, 938.0, 970.0, 953.0, 970.0, 947.0, 952.0, 981.0, 963.0, 949.0, 954.0, 961.0, 940.0, 955.0, 965.0, 981.0, 950.0, 967.0, 940.0, 938.0, 957.0, 970.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3619909703627255, "mean_inference_ms": 1.7949311443043778, "mean_action_processing_ms": 0.1336052786615663, "mean_env_wait_ms": 0.12382797168749807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026178956031799316, "StateBufferConnector_ms": 0.005341768264770508, "ViewRequirementAgentConnector_ms": 0.13130903244018555}, "num_episodes": 40, "episode_return_max": 989.0, "episode_return_min": 935.0, "episode_return_mean": 957.075, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.15155635362595, "num_env_steps_trained_throughput_per_sec": 230.15155635362595, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 17379.873, "restore_workers_time_ms": 0.03, "training_step_time_ms": 17379.749, "sample_time_ms": 9742.478, "load_time_ms": 0.395, "load_throughput": 10125054.919, "learn_time_ms": 7627.719, "learn_throughput": 524.403, "synch_weights_time_ms": 8.079}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_00-28-15", "timestamp": 1716103695, "time_this_iter_s": 17.388066053390503, "time_total_s": 17.388066053390503, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17.388066053390503, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.132, "ram_util_percent": 51.348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9359926814033139, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.869729839858188, "policy_loss": -0.029133338464163643, "vf_loss": 19.89706038813437, "vf_explained_var": 0.00042075130247300674, "kl": 0.009014133035584942, "entropy": 0.6752969644402945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 989.0, "episode_reward_min": 924.0, "episode_reward_mean": 958.3125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [937.0, 966.0, 942.0, 964.0, 969.0, 935.0, 983.0, 960.0, 961.0, 964.0, 944.0, 957.0, 941.0, 953.0, 989.0, 941.0, 946.0, 977.0, 953.0, 938.0, 970.0, 953.0, 970.0, 947.0, 952.0, 981.0, 963.0, 949.0, 954.0, 961.0, 940.0, 955.0, 965.0, 981.0, 950.0, 967.0, 940.0, 938.0, 957.0, 970.0, 967.0, 963.0, 960.0, 963.0, 943.0, 957.0, 924.0, 952.0, 976.0, 935.0, 961.0, 968.0, 957.0, 986.0, 961.0, 958.0, 961.0, 950.0, 962.0, 924.0, 955.0, 957.0, 977.0, 982.0, 975.0, 945.0, 949.0, 976.0, 977.0, 955.0, 968.0, 986.0, 970.0, 949.0, 935.0, 980.0, 979.0, 962.0, 945.0, 932.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36657778356220183, "mean_inference_ms": 1.8261655796457972, "mean_action_processing_ms": 0.1358071772109282, "mean_env_wait_ms": 0.12547305350873755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02518683671951294, "StateBufferConnector_ms": 0.006260573863983154, "ViewRequirementAgentConnector_ms": 0.13526946306228638}, "num_episodes": 40, "episode_return_max": 989.0, "episode_return_min": 924.0, "episode_return_mean": 958.3125}, "env_runner_results": {"episode_reward_max": 989.0, "episode_reward_min": 924.0, "episode_reward_mean": 958.3125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [937.0, 966.0, 942.0, 964.0, 969.0, 935.0, 983.0, 960.0, 961.0, 964.0, 944.0, 957.0, 941.0, 953.0, 989.0, 941.0, 946.0, 977.0, 953.0, 938.0, 970.0, 953.0, 970.0, 947.0, 952.0, 981.0, 963.0, 949.0, 954.0, 961.0, 940.0, 955.0, 965.0, 981.0, 950.0, 967.0, 940.0, 938.0, 957.0, 970.0, 967.0, 963.0, 960.0, 963.0, 943.0, 957.0, 924.0, 952.0, 976.0, 935.0, 961.0, 968.0, 957.0, 986.0, 961.0, 958.0, 961.0, 950.0, 962.0, 924.0, 955.0, 957.0, 977.0, 982.0, 975.0, 945.0, 949.0, 976.0, 977.0, 955.0, 968.0, 986.0, 970.0, 949.0, 935.0, 980.0, 979.0, 962.0, 945.0, 932.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36657778356220183, "mean_inference_ms": 1.8261655796457972, "mean_action_processing_ms": 0.1358071772109282, "mean_env_wait_ms": 0.12547305350873755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02518683671951294, "StateBufferConnector_ms": 0.006260573863983154, "ViewRequirementAgentConnector_ms": 0.13526946306228638}, "num_episodes": 40, "episode_return_max": 989.0, "episode_return_min": 924.0, "episode_return_mean": 958.3125}, "episode_reward_max": 989.0, "episode_reward_min": 924.0, "episode_reward_mean": 958.3125, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [937.0, 966.0, 942.0, 964.0, 969.0, 935.0, 983.0, 960.0, 961.0, 964.0, 944.0, 957.0, 941.0, 953.0, 989.0, 941.0, 946.0, 977.0, 953.0, 938.0, 970.0, 953.0, 970.0, 947.0, 952.0, 981.0, 963.0, 949.0, 954.0, 961.0, 940.0, 955.0, 965.0, 981.0, 950.0, 967.0, 940.0, 938.0, 957.0, 970.0, 967.0, 963.0, 960.0, 963.0, 943.0, 957.0, 924.0, 952.0, 976.0, 935.0, 961.0, 968.0, 957.0, 986.0, 961.0, 958.0, 961.0, 950.0, 962.0, 924.0, 955.0, 957.0, 977.0, 982.0, 975.0, 945.0, 949.0, 976.0, 977.0, 955.0, 968.0, 986.0, 970.0, 949.0, 935.0, 980.0, 979.0, 962.0, 945.0, 932.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36657778356220183, "mean_inference_ms": 1.8261655796457972, "mean_action_processing_ms": 0.1358071772109282, "mean_env_wait_ms": 0.12547305350873755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02518683671951294, "StateBufferConnector_ms": 0.006260573863983154, "ViewRequirementAgentConnector_ms": 0.13526946306228638}, "num_episodes": 40, "episode_return_max": 989.0, "episode_return_min": 924.0, "episode_return_mean": 958.3125, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 225.77188174652522, "num_env_steps_trained_throughput_per_sec": 225.77188174652522, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 17548.442, "restore_workers_time_ms": 0.024, "training_step_time_ms": 17548.35, "sample_time_ms": 10058.191, "load_time_ms": 0.405, "load_throughput": 9866048.809, "learn_time_ms": 7480.856, "learn_throughput": 534.698, "synch_weights_time_ms": 8.037}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_00-28-32", "timestamp": 1716103712, "time_this_iter_s": 17.725593090057373, "time_total_s": 35.113659143447876, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 35.113659143447876, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.184, "ram_util_percent": 50.424}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.011673541639441, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.893016919782085, "policy_loss": -0.03562171837435134, "vf_loss": 19.926486382433165, "vf_explained_var": 0.00041644336074911137, "kl": 0.010761199414990371, "entropy": 0.6525257183018551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 998.0, "episode_reward_min": 924.0, "episode_reward_mean": 959.89, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [970.0, 953.0, 970.0, 947.0, 952.0, 981.0, 963.0, 949.0, 954.0, 961.0, 940.0, 955.0, 965.0, 981.0, 950.0, 967.0, 940.0, 938.0, 957.0, 970.0, 967.0, 963.0, 960.0, 963.0, 943.0, 957.0, 924.0, 952.0, 976.0, 935.0, 961.0, 968.0, 957.0, 986.0, 961.0, 958.0, 961.0, 950.0, 962.0, 924.0, 955.0, 957.0, 977.0, 982.0, 975.0, 945.0, 949.0, 976.0, 977.0, 955.0, 968.0, 986.0, 970.0, 949.0, 935.0, 980.0, 979.0, 962.0, 945.0, 932.0, 937.0, 936.0, 970.0, 968.0, 955.0, 974.0, 932.0, 950.0, 944.0, 980.0, 974.0, 963.0, 964.0, 967.0, 983.0, 961.0, 969.0, 960.0, 969.0, 970.0, 944.0, 953.0, 931.0, 939.0, 998.0, 957.0, 959.0, 941.0, 995.0, 948.0, 971.0, 972.0, 942.0, 947.0, 979.0, 991.0, 939.0, 979.0, 969.0, 964.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.365916457963708, "mean_inference_ms": 1.825825894600812, "mean_action_processing_ms": 0.13578057631095394, "mean_env_wait_ms": 0.1255037231435085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024133920669555664, "StateBufferConnector_ms": 0.006111860275268555, "ViewRequirementAgentConnector_ms": 0.1325838565826416}, "num_episodes": 40, "episode_return_max": 998.0, "episode_return_min": 924.0, "episode_return_mean": 959.89}, "env_runner_results": {"episode_reward_max": 998.0, "episode_reward_min": 924.0, "episode_reward_mean": 959.89, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [970.0, 953.0, 970.0, 947.0, 952.0, 981.0, 963.0, 949.0, 954.0, 961.0, 940.0, 955.0, 965.0, 981.0, 950.0, 967.0, 940.0, 938.0, 957.0, 970.0, 967.0, 963.0, 960.0, 963.0, 943.0, 957.0, 924.0, 952.0, 976.0, 935.0, 961.0, 968.0, 957.0, 986.0, 961.0, 958.0, 961.0, 950.0, 962.0, 924.0, 955.0, 957.0, 977.0, 982.0, 975.0, 945.0, 949.0, 976.0, 977.0, 955.0, 968.0, 986.0, 970.0, 949.0, 935.0, 980.0, 979.0, 962.0, 945.0, 932.0, 937.0, 936.0, 970.0, 968.0, 955.0, 974.0, 932.0, 950.0, 944.0, 980.0, 974.0, 963.0, 964.0, 967.0, 983.0, 961.0, 969.0, 960.0, 969.0, 970.0, 944.0, 953.0, 931.0, 939.0, 998.0, 957.0, 959.0, 941.0, 995.0, 948.0, 971.0, 972.0, 942.0, 947.0, 979.0, 991.0, 939.0, 979.0, 969.0, 964.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.365916457963708, "mean_inference_ms": 1.825825894600812, "mean_action_processing_ms": 0.13578057631095394, "mean_env_wait_ms": 0.1255037231435085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024133920669555664, "StateBufferConnector_ms": 0.006111860275268555, "ViewRequirementAgentConnector_ms": 0.1325838565826416}, "num_episodes": 40, "episode_return_max": 998.0, "episode_return_min": 924.0, "episode_return_mean": 959.89}, "episode_reward_max": 998.0, "episode_reward_min": 924.0, "episode_reward_mean": 959.89, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [970.0, 953.0, 970.0, 947.0, 952.0, 981.0, 963.0, 949.0, 954.0, 961.0, 940.0, 955.0, 965.0, 981.0, 950.0, 967.0, 940.0, 938.0, 957.0, 970.0, 967.0, 963.0, 960.0, 963.0, 943.0, 957.0, 924.0, 952.0, 976.0, 935.0, 961.0, 968.0, 957.0, 986.0, 961.0, 958.0, 961.0, 950.0, 962.0, 924.0, 955.0, 957.0, 977.0, 982.0, 975.0, 945.0, 949.0, 976.0, 977.0, 955.0, 968.0, 986.0, 970.0, 949.0, 935.0, 980.0, 979.0, 962.0, 945.0, 932.0, 937.0, 936.0, 970.0, 968.0, 955.0, 974.0, 932.0, 950.0, 944.0, 980.0, 974.0, 963.0, 964.0, 967.0, 983.0, 961.0, 969.0, 960.0, 969.0, 970.0, 944.0, 953.0, 931.0, 939.0, 998.0, 957.0, 959.0, 941.0, 995.0, 948.0, 971.0, 972.0, 942.0, 947.0, 979.0, 991.0, 939.0, 979.0, 969.0, 964.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.365916457963708, "mean_inference_ms": 1.825825894600812, "mean_action_processing_ms": 0.13578057631095394, "mean_env_wait_ms": 0.1255037231435085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024133920669555664, "StateBufferConnector_ms": 0.006111860275268555, "ViewRequirementAgentConnector_ms": 0.1325838565826416}, "num_episodes": 40, "episode_return_max": 998.0, "episode_return_min": 924.0, "episode_return_mean": 959.89, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.48241495876826, "num_env_steps_trained_throughput_per_sec": 240.48241495876826, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 17243.376, "restore_workers_time_ms": 0.021, "training_step_time_ms": 17243.295, "sample_time_ms": 9804.893, "load_time_ms": 0.413, "load_throughput": 9694077.042, "learn_time_ms": 7429.687, "learn_throughput": 538.381, "synch_weights_time_ms": 7.525}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_00-28-49", "timestamp": 1716103729, "time_this_iter_s": 16.641175031661987, "time_total_s": 51.75483417510986, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.75483417510986, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.225, "ram_util_percent": 50.32083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1467869033095657, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.893488512757003, "policy_loss": -0.038539869378831595, "vf_loss": 19.930005811875866, "vf_explained_var": 0.00034909626489044516, "kl": 0.010113202773286183, "entropy": 0.6381773459014072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 998.0, "episode_reward_min": 931.0, "episode_reward_mean": 960.46, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [955.0, 957.0, 977.0, 982.0, 975.0, 945.0, 949.0, 976.0, 977.0, 955.0, 968.0, 986.0, 970.0, 949.0, 935.0, 980.0, 979.0, 962.0, 945.0, 932.0, 937.0, 936.0, 970.0, 968.0, 955.0, 974.0, 932.0, 950.0, 944.0, 980.0, 974.0, 963.0, 964.0, 967.0, 983.0, 961.0, 969.0, 960.0, 969.0, 970.0, 944.0, 953.0, 931.0, 939.0, 998.0, 957.0, 959.0, 941.0, 995.0, 948.0, 971.0, 972.0, 942.0, 947.0, 979.0, 991.0, 939.0, 979.0, 969.0, 964.0, 933.0, 940.0, 957.0, 957.0, 974.0, 938.0, 954.0, 944.0, 950.0, 965.0, 937.0, 954.0, 961.0, 966.0, 947.0, 975.0, 952.0, 966.0, 956.0, 961.0, 963.0, 975.0, 937.0, 988.0, 968.0, 963.0, 964.0, 971.0, 973.0, 969.0, 958.0, 969.0, 980.0, 949.0, 938.0, 979.0, 955.0, 951.0, 968.0, 943.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3626990205540409, "mean_inference_ms": 1.8145341247580813, "mean_action_processing_ms": 0.13468952782122795, "mean_env_wait_ms": 0.12478582794542518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023549556732177734, "StateBufferConnector_ms": 0.0060520172119140625, "ViewRequirementAgentConnector_ms": 0.12961483001708984}, "num_episodes": 40, "episode_return_max": 998.0, "episode_return_min": 931.0, "episode_return_mean": 960.46}, "env_runner_results": {"episode_reward_max": 998.0, "episode_reward_min": 931.0, "episode_reward_mean": 960.46, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [955.0, 957.0, 977.0, 982.0, 975.0, 945.0, 949.0, 976.0, 977.0, 955.0, 968.0, 986.0, 970.0, 949.0, 935.0, 980.0, 979.0, 962.0, 945.0, 932.0, 937.0, 936.0, 970.0, 968.0, 955.0, 974.0, 932.0, 950.0, 944.0, 980.0, 974.0, 963.0, 964.0, 967.0, 983.0, 961.0, 969.0, 960.0, 969.0, 970.0, 944.0, 953.0, 931.0, 939.0, 998.0, 957.0, 959.0, 941.0, 995.0, 948.0, 971.0, 972.0, 942.0, 947.0, 979.0, 991.0, 939.0, 979.0, 969.0, 964.0, 933.0, 940.0, 957.0, 957.0, 974.0, 938.0, 954.0, 944.0, 950.0, 965.0, 937.0, 954.0, 961.0, 966.0, 947.0, 975.0, 952.0, 966.0, 956.0, 961.0, 963.0, 975.0, 937.0, 988.0, 968.0, 963.0, 964.0, 971.0, 973.0, 969.0, 958.0, 969.0, 980.0, 949.0, 938.0, 979.0, 955.0, 951.0, 968.0, 943.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3626990205540409, "mean_inference_ms": 1.8145341247580813, "mean_action_processing_ms": 0.13468952782122795, "mean_env_wait_ms": 0.12478582794542518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023549556732177734, "StateBufferConnector_ms": 0.0060520172119140625, "ViewRequirementAgentConnector_ms": 0.12961483001708984}, "num_episodes": 40, "episode_return_max": 998.0, "episode_return_min": 931.0, "episode_return_mean": 960.46}, "episode_reward_max": 998.0, "episode_reward_min": 931.0, "episode_reward_mean": 960.46, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [955.0, 957.0, 977.0, 982.0, 975.0, 945.0, 949.0, 976.0, 977.0, 955.0, 968.0, 986.0, 970.0, 949.0, 935.0, 980.0, 979.0, 962.0, 945.0, 932.0, 937.0, 936.0, 970.0, 968.0, 955.0, 974.0, 932.0, 950.0, 944.0, 980.0, 974.0, 963.0, 964.0, 967.0, 983.0, 961.0, 969.0, 960.0, 969.0, 970.0, 944.0, 953.0, 931.0, 939.0, 998.0, 957.0, 959.0, 941.0, 995.0, 948.0, 971.0, 972.0, 942.0, 947.0, 979.0, 991.0, 939.0, 979.0, 969.0, 964.0, 933.0, 940.0, 957.0, 957.0, 974.0, 938.0, 954.0, 944.0, 950.0, 965.0, 937.0, 954.0, 961.0, 966.0, 947.0, 975.0, 952.0, 966.0, 956.0, 961.0, 963.0, 975.0, 937.0, 988.0, 968.0, 963.0, 964.0, 971.0, 973.0, 969.0, 958.0, 969.0, 980.0, 949.0, 938.0, 979.0, 955.0, 951.0, 968.0, 943.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3626990205540409, "mean_inference_ms": 1.8145341247580813, "mean_action_processing_ms": 0.13468952782122795, "mean_env_wait_ms": 0.12478582794542518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023549556732177734, "StateBufferConnector_ms": 0.0060520172119140625, "ViewRequirementAgentConnector_ms": 0.12961483001708984}, "num_episodes": 40, "episode_return_max": 998.0, "episode_return_min": 931.0, "episode_return_mean": 960.46, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.80672927540044, "num_env_steps_trained_throughput_per_sec": 237.80672927540044, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 17137.63, "restore_workers_time_ms": 0.02, "training_step_time_ms": 17137.555, "sample_time_ms": 9728.154, "load_time_ms": 0.427, "load_throughput": 9363592.019, "learn_time_ms": 7400.631, "learn_throughput": 540.494, "synch_weights_time_ms": 7.594}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_00-29-06", "timestamp": 1716103746, "time_this_iter_s": 16.828470706939697, "time_total_s": 68.58330488204956, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 68.58330488204956, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.00416666666667, "ram_util_percent": 49.883333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2465231614087218, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.83123254263273, "policy_loss": -0.04072952953677985, "vf_loss": 19.8696750456287, "vf_explained_var": 0.00042924720753905593, "kl": 0.011435090618058868, "entropy": 0.6321724197556896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 998.0, "episode_reward_min": 907.0, "episode_reward_mean": 957.29, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [944.0, 953.0, 931.0, 939.0, 998.0, 957.0, 959.0, 941.0, 995.0, 948.0, 971.0, 972.0, 942.0, 947.0, 979.0, 991.0, 939.0, 979.0, 969.0, 964.0, 933.0, 940.0, 957.0, 957.0, 974.0, 938.0, 954.0, 944.0, 950.0, 965.0, 937.0, 954.0, 961.0, 966.0, 947.0, 975.0, 952.0, 966.0, 956.0, 961.0, 963.0, 975.0, 937.0, 988.0, 968.0, 963.0, 964.0, 971.0, 973.0, 969.0, 958.0, 969.0, 980.0, 949.0, 938.0, 979.0, 955.0, 951.0, 968.0, 943.0, 951.0, 987.0, 978.0, 936.0, 951.0, 936.0, 954.0, 956.0, 949.0, 980.0, 954.0, 978.0, 978.0, 967.0, 929.0, 954.0, 968.0, 907.0, 943.0, 926.0, 950.0, 946.0, 943.0, 934.0, 938.0, 931.0, 961.0, 977.0, 967.0, 961.0, 928.0, 946.0, 972.0, 944.0, 946.0, 975.0, 953.0, 975.0, 971.0, 963.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3585570072108423, "mean_inference_ms": 1.7945160788834185, "mean_action_processing_ms": 0.13303145542181727, "mean_env_wait_ms": 0.12363453084924579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02311849594116211, "StateBufferConnector_ms": 0.005295276641845703, "ViewRequirementAgentConnector_ms": 0.12626171112060547}, "num_episodes": 40, "episode_return_max": 998.0, "episode_return_min": 907.0, "episode_return_mean": 957.29}, "env_runner_results": {"episode_reward_max": 998.0, "episode_reward_min": 907.0, "episode_reward_mean": 957.29, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [944.0, 953.0, 931.0, 939.0, 998.0, 957.0, 959.0, 941.0, 995.0, 948.0, 971.0, 972.0, 942.0, 947.0, 979.0, 991.0, 939.0, 979.0, 969.0, 964.0, 933.0, 940.0, 957.0, 957.0, 974.0, 938.0, 954.0, 944.0, 950.0, 965.0, 937.0, 954.0, 961.0, 966.0, 947.0, 975.0, 952.0, 966.0, 956.0, 961.0, 963.0, 975.0, 937.0, 988.0, 968.0, 963.0, 964.0, 971.0, 973.0, 969.0, 958.0, 969.0, 980.0, 949.0, 938.0, 979.0, 955.0, 951.0, 968.0, 943.0, 951.0, 987.0, 978.0, 936.0, 951.0, 936.0, 954.0, 956.0, 949.0, 980.0, 954.0, 978.0, 978.0, 967.0, 929.0, 954.0, 968.0, 907.0, 943.0, 926.0, 950.0, 946.0, 943.0, 934.0, 938.0, 931.0, 961.0, 977.0, 967.0, 961.0, 928.0, 946.0, 972.0, 944.0, 946.0, 975.0, 953.0, 975.0, 971.0, 963.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3585570072108423, "mean_inference_ms": 1.7945160788834185, "mean_action_processing_ms": 0.13303145542181727, "mean_env_wait_ms": 0.12363453084924579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02311849594116211, "StateBufferConnector_ms": 0.005295276641845703, "ViewRequirementAgentConnector_ms": 0.12626171112060547}, "num_episodes": 40, "episode_return_max": 998.0, "episode_return_min": 907.0, "episode_return_mean": 957.29}, "episode_reward_max": 998.0, "episode_reward_min": 907.0, "episode_reward_mean": 957.29, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [944.0, 953.0, 931.0, 939.0, 998.0, 957.0, 959.0, 941.0, 995.0, 948.0, 971.0, 972.0, 942.0, 947.0, 979.0, 991.0, 939.0, 979.0, 969.0, 964.0, 933.0, 940.0, 957.0, 957.0, 974.0, 938.0, 954.0, 944.0, 950.0, 965.0, 937.0, 954.0, 961.0, 966.0, 947.0, 975.0, 952.0, 966.0, 956.0, 961.0, 963.0, 975.0, 937.0, 988.0, 968.0, 963.0, 964.0, 971.0, 973.0, 969.0, 958.0, 969.0, 980.0, 949.0, 938.0, 979.0, 955.0, 951.0, 968.0, 943.0, 951.0, 987.0, 978.0, 936.0, 951.0, 936.0, 954.0, 956.0, 949.0, 980.0, 954.0, 978.0, 978.0, 967.0, 929.0, 954.0, 968.0, 907.0, 943.0, 926.0, 950.0, 946.0, 943.0, 934.0, 938.0, 931.0, 961.0, 977.0, 967.0, 961.0, 928.0, 946.0, 972.0, 944.0, 946.0, 975.0, 953.0, 975.0, 971.0, 963.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3585570072108423, "mean_inference_ms": 1.7945160788834185, "mean_action_processing_ms": 0.13303145542181727, "mean_env_wait_ms": 0.12363453084924579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02311849594116211, "StateBufferConnector_ms": 0.005295276641845703, "ViewRequirementAgentConnector_ms": 0.12626171112060547}, "num_episodes": 40, "episode_return_max": 998.0, "episode_return_min": 907.0, "episode_return_mean": 957.29, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.0675456939519, "num_env_steps_trained_throughput_per_sec": 239.0675456939519, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 17056.441, "restore_workers_time_ms": 0.019, "training_step_time_ms": 17056.371, "sample_time_ms": 9655.031, "load_time_ms": 0.431, "load_throughput": 9277381.11, "learn_time_ms": 7392.864, "learn_throughput": 541.062, "synch_weights_time_ms": 7.321}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_00-29-23", "timestamp": 1716103763, "time_this_iter_s": 16.7397198677063, "time_total_s": 85.32302474975586, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 85.32302474975586, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.520833333333336, "ram_util_percent": 49.616666666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4772196765868895, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.850997440789335, "policy_loss": -0.04262351296661842, "vf_loss": 19.891319367193407, "vf_explained_var": 0.00034933154300976826, "kl": 0.011508014031527397, "entropy": 0.6177504450403234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": 907.0, "episode_reward_mean": 957.59, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [963.0, 975.0, 937.0, 988.0, 968.0, 963.0, 964.0, 971.0, 973.0, 969.0, 958.0, 969.0, 980.0, 949.0, 938.0, 979.0, 955.0, 951.0, 968.0, 943.0, 951.0, 987.0, 978.0, 936.0, 951.0, 936.0, 954.0, 956.0, 949.0, 980.0, 954.0, 978.0, 978.0, 967.0, 929.0, 954.0, 968.0, 907.0, 943.0, 926.0, 950.0, 946.0, 943.0, 934.0, 938.0, 931.0, 961.0, 977.0, 967.0, 961.0, 928.0, 946.0, 972.0, 944.0, 946.0, 975.0, 953.0, 975.0, 971.0, 963.0, 915.0, 938.0, 983.0, 965.0, 942.0, 956.0, 930.0, 955.0, 955.0, 960.0, 975.0, 986.0, 944.0, 946.0, 968.0, 963.0, 953.0, 952.0, 983.0, 967.0, 950.0, 963.0, 979.0, 951.0, 963.0, 945.0, 947.0, 952.0, 978.0, 950.0, 949.0, 976.0, 997.0, 964.0, 962.0, 961.0, 967.0, 955.0, 964.0, 926.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3563383880498479, "mean_inference_ms": 1.7819465392890372, "mean_action_processing_ms": 0.13208133301276784, "mean_env_wait_ms": 0.12298701995362095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023280620574951172, "StateBufferConnector_ms": 0.005378246307373047, "ViewRequirementAgentConnector_ms": 0.12600183486938477}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 907.0, "episode_return_mean": 957.59}, "env_runner_results": {"episode_reward_max": 997.0, "episode_reward_min": 907.0, "episode_reward_mean": 957.59, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [963.0, 975.0, 937.0, 988.0, 968.0, 963.0, 964.0, 971.0, 973.0, 969.0, 958.0, 969.0, 980.0, 949.0, 938.0, 979.0, 955.0, 951.0, 968.0, 943.0, 951.0, 987.0, 978.0, 936.0, 951.0, 936.0, 954.0, 956.0, 949.0, 980.0, 954.0, 978.0, 978.0, 967.0, 929.0, 954.0, 968.0, 907.0, 943.0, 926.0, 950.0, 946.0, 943.0, 934.0, 938.0, 931.0, 961.0, 977.0, 967.0, 961.0, 928.0, 946.0, 972.0, 944.0, 946.0, 975.0, 953.0, 975.0, 971.0, 963.0, 915.0, 938.0, 983.0, 965.0, 942.0, 956.0, 930.0, 955.0, 955.0, 960.0, 975.0, 986.0, 944.0, 946.0, 968.0, 963.0, 953.0, 952.0, 983.0, 967.0, 950.0, 963.0, 979.0, 951.0, 963.0, 945.0, 947.0, 952.0, 978.0, 950.0, 949.0, 976.0, 997.0, 964.0, 962.0, 961.0, 967.0, 955.0, 964.0, 926.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3563383880498479, "mean_inference_ms": 1.7819465392890372, "mean_action_processing_ms": 0.13208133301276784, "mean_env_wait_ms": 0.12298701995362095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023280620574951172, "StateBufferConnector_ms": 0.005378246307373047, "ViewRequirementAgentConnector_ms": 0.12600183486938477}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 907.0, "episode_return_mean": 957.59}, "episode_reward_max": 997.0, "episode_reward_min": 907.0, "episode_reward_mean": 957.59, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [963.0, 975.0, 937.0, 988.0, 968.0, 963.0, 964.0, 971.0, 973.0, 969.0, 958.0, 969.0, 980.0, 949.0, 938.0, 979.0, 955.0, 951.0, 968.0, 943.0, 951.0, 987.0, 978.0, 936.0, 951.0, 936.0, 954.0, 956.0, 949.0, 980.0, 954.0, 978.0, 978.0, 967.0, 929.0, 954.0, 968.0, 907.0, 943.0, 926.0, 950.0, 946.0, 943.0, 934.0, 938.0, 931.0, 961.0, 977.0, 967.0, 961.0, 928.0, 946.0, 972.0, 944.0, 946.0, 975.0, 953.0, 975.0, 971.0, 963.0, 915.0, 938.0, 983.0, 965.0, 942.0, 956.0, 930.0, 955.0, 955.0, 960.0, 975.0, 986.0, 944.0, 946.0, 968.0, 963.0, 953.0, 952.0, 983.0, 967.0, 950.0, 963.0, 979.0, 951.0, 963.0, 945.0, 947.0, 952.0, 978.0, 950.0, 949.0, 976.0, 997.0, 964.0, 962.0, 961.0, 967.0, 955.0, 964.0, 926.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3563383880498479, "mean_inference_ms": 1.7819465392890372, "mean_action_processing_ms": 0.13208133301276784, "mean_env_wait_ms": 0.12298701995362095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023280620574951172, "StateBufferConnector_ms": 0.005378246307373047, "ViewRequirementAgentConnector_ms": 0.12600183486938477}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 907.0, "episode_return_mean": 957.59, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.7370822393633, "num_env_steps_trained_throughput_per_sec": 239.7370822393633, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 16994.527, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16994.461, "sample_time_ms": 9598.902, "load_time_ms": 0.431, "load_throughput": 9274304.035, "learn_time_ms": 7386.975, "learn_throughput": 541.494, "synch_weights_time_ms": 7.456}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_00-29-39", "timestamp": 1716103779, "time_this_iter_s": 16.693691730499268, "time_total_s": 102.01671648025513, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.01671648025513, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.4125, "ram_util_percent": 49.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.663867885322981, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.830713007527013, "policy_loss": -0.03998418127497037, "vf_loss": 19.868431351774483, "vf_explained_var": 0.000539023260916433, "kl": 0.011329248798799403, "entropy": 0.5984770364658807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": 907.0, "episode_reward_mean": 956.14, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 946.0, 943.0, 934.0, 938.0, 931.0, 961.0, 977.0, 967.0, 961.0, 928.0, 946.0, 972.0, 944.0, 946.0, 975.0, 953.0, 975.0, 971.0, 963.0, 915.0, 938.0, 983.0, 965.0, 942.0, 956.0, 930.0, 955.0, 955.0, 960.0, 975.0, 986.0, 944.0, 946.0, 968.0, 963.0, 953.0, 952.0, 983.0, 967.0, 950.0, 963.0, 979.0, 951.0, 963.0, 945.0, 947.0, 952.0, 978.0, 950.0, 949.0, 976.0, 997.0, 964.0, 962.0, 961.0, 967.0, 955.0, 964.0, 926.0, 947.0, 947.0, 959.0, 951.0, 948.0, 939.0, 937.0, 931.0, 974.0, 955.0, 958.0, 977.0, 945.0, 981.0, 941.0, 954.0, 962.0, 958.0, 948.0, 966.0, 932.0, 967.0, 931.0, 971.0, 941.0, 967.0, 964.0, 907.0, 974.0, 966.0, 952.0, 958.0, 943.0, 953.0, 960.0, 969.0, 953.0, 973.0, 968.0, 971.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3549033831084975, "mean_inference_ms": 1.77152217832707, "mean_action_processing_ms": 0.1314267662467059, "mean_env_wait_ms": 0.12253846673113725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023381471633911133, "StateBufferConnector_ms": 0.005319118499755859, "ViewRequirementAgentConnector_ms": 0.12591052055358887}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 907.0, "episode_return_mean": 956.14}, "env_runner_results": {"episode_reward_max": 997.0, "episode_reward_min": 907.0, "episode_reward_mean": 956.14, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 946.0, 943.0, 934.0, 938.0, 931.0, 961.0, 977.0, 967.0, 961.0, 928.0, 946.0, 972.0, 944.0, 946.0, 975.0, 953.0, 975.0, 971.0, 963.0, 915.0, 938.0, 983.0, 965.0, 942.0, 956.0, 930.0, 955.0, 955.0, 960.0, 975.0, 986.0, 944.0, 946.0, 968.0, 963.0, 953.0, 952.0, 983.0, 967.0, 950.0, 963.0, 979.0, 951.0, 963.0, 945.0, 947.0, 952.0, 978.0, 950.0, 949.0, 976.0, 997.0, 964.0, 962.0, 961.0, 967.0, 955.0, 964.0, 926.0, 947.0, 947.0, 959.0, 951.0, 948.0, 939.0, 937.0, 931.0, 974.0, 955.0, 958.0, 977.0, 945.0, 981.0, 941.0, 954.0, 962.0, 958.0, 948.0, 966.0, 932.0, 967.0, 931.0, 971.0, 941.0, 967.0, 964.0, 907.0, 974.0, 966.0, 952.0, 958.0, 943.0, 953.0, 960.0, 969.0, 953.0, 973.0, 968.0, 971.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3549033831084975, "mean_inference_ms": 1.77152217832707, "mean_action_processing_ms": 0.1314267662467059, "mean_env_wait_ms": 0.12253846673113725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023381471633911133, "StateBufferConnector_ms": 0.005319118499755859, "ViewRequirementAgentConnector_ms": 0.12591052055358887}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 907.0, "episode_return_mean": 956.14}, "episode_reward_max": 997.0, "episode_reward_min": 907.0, "episode_reward_mean": 956.14, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [950.0, 946.0, 943.0, 934.0, 938.0, 931.0, 961.0, 977.0, 967.0, 961.0, 928.0, 946.0, 972.0, 944.0, 946.0, 975.0, 953.0, 975.0, 971.0, 963.0, 915.0, 938.0, 983.0, 965.0, 942.0, 956.0, 930.0, 955.0, 955.0, 960.0, 975.0, 986.0, 944.0, 946.0, 968.0, 963.0, 953.0, 952.0, 983.0, 967.0, 950.0, 963.0, 979.0, 951.0, 963.0, 945.0, 947.0, 952.0, 978.0, 950.0, 949.0, 976.0, 997.0, 964.0, 962.0, 961.0, 967.0, 955.0, 964.0, 926.0, 947.0, 947.0, 959.0, 951.0, 948.0, 939.0, 937.0, 931.0, 974.0, 955.0, 958.0, 977.0, 945.0, 981.0, 941.0, 954.0, 962.0, 958.0, 948.0, 966.0, 932.0, 967.0, 931.0, 971.0, 941.0, 967.0, 964.0, 907.0, 974.0, 966.0, 952.0, 958.0, 943.0, 953.0, 960.0, 969.0, 953.0, 973.0, 968.0, 971.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3549033831084975, "mean_inference_ms": 1.77152217832707, "mean_action_processing_ms": 0.1314267662467059, "mean_env_wait_ms": 0.12253846673113725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023381471633911133, "StateBufferConnector_ms": 0.005319118499755859, "ViewRequirementAgentConnector_ms": 0.12591052055358887}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 907.0, "episode_return_mean": 956.14, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.1422559802539, "num_env_steps_trained_throughput_per_sec": 238.1422559802539, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 16966.266, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16966.189, "sample_time_ms": 9559.366, "load_time_ms": 0.432, "load_throughput": 9269180.11, "learn_time_ms": 7398.386, "learn_throughput": 540.658, "synch_weights_time_ms": 7.329}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_00-29-56", "timestamp": 1716103796, "time_this_iter_s": 16.804678201675415, "time_total_s": 118.82139468193054, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 118.82139468193054, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.875, "ram_util_percent": 49.40833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.712135325644606, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.867555021470594, "policy_loss": -0.04071809959107189, "vf_loss": 19.90606354334021, "vf_explained_var": 0.0006024324124859226, "kl": 0.011048221353223042, "entropy": 0.5882587671279907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": 907.0, "episode_reward_mean": 956.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 963.0, 979.0, 951.0, 963.0, 945.0, 947.0, 952.0, 978.0, 950.0, 949.0, 976.0, 997.0, 964.0, 962.0, 961.0, 967.0, 955.0, 964.0, 926.0, 947.0, 947.0, 959.0, 951.0, 948.0, 939.0, 937.0, 931.0, 974.0, 955.0, 958.0, 977.0, 945.0, 981.0, 941.0, 954.0, 962.0, 958.0, 948.0, 966.0, 932.0, 967.0, 931.0, 971.0, 941.0, 967.0, 964.0, 907.0, 974.0, 966.0, 952.0, 958.0, 943.0, 953.0, 960.0, 969.0, 953.0, 973.0, 968.0, 971.0, 959.0, 940.0, 965.0, 954.0, 939.0, 971.0, 969.0, 963.0, 985.0, 981.0, 946.0, 932.0, 951.0, 935.0, 960.0, 939.0, 949.0, 925.0, 936.0, 954.0, 965.0, 969.0, 948.0, 956.0, 961.0, 963.0, 970.0, 946.0, 953.0, 959.0, 969.0, 970.0, 962.0, 942.0, 978.0, 946.0, 970.0, 961.0, 969.0, 985.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3543377102570357, "mean_inference_ms": 1.766448692039891, "mean_action_processing_ms": 0.13113291986409847, "mean_env_wait_ms": 0.12236354304989325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023486852645874023, "StateBufferConnector_ms": 0.005330324172973633, "ViewRequirementAgentConnector_ms": 0.12734508514404297}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 907.0, "episode_return_mean": 956.92}, "env_runner_results": {"episode_reward_max": 997.0, "episode_reward_min": 907.0, "episode_reward_mean": 956.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 963.0, 979.0, 951.0, 963.0, 945.0, 947.0, 952.0, 978.0, 950.0, 949.0, 976.0, 997.0, 964.0, 962.0, 961.0, 967.0, 955.0, 964.0, 926.0, 947.0, 947.0, 959.0, 951.0, 948.0, 939.0, 937.0, 931.0, 974.0, 955.0, 958.0, 977.0, 945.0, 981.0, 941.0, 954.0, 962.0, 958.0, 948.0, 966.0, 932.0, 967.0, 931.0, 971.0, 941.0, 967.0, 964.0, 907.0, 974.0, 966.0, 952.0, 958.0, 943.0, 953.0, 960.0, 969.0, 953.0, 973.0, 968.0, 971.0, 959.0, 940.0, 965.0, 954.0, 939.0, 971.0, 969.0, 963.0, 985.0, 981.0, 946.0, 932.0, 951.0, 935.0, 960.0, 939.0, 949.0, 925.0, 936.0, 954.0, 965.0, 969.0, 948.0, 956.0, 961.0, 963.0, 970.0, 946.0, 953.0, 959.0, 969.0, 970.0, 962.0, 942.0, 978.0, 946.0, 970.0, 961.0, 969.0, 985.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3543377102570357, "mean_inference_ms": 1.766448692039891, "mean_action_processing_ms": 0.13113291986409847, "mean_env_wait_ms": 0.12236354304989325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023486852645874023, "StateBufferConnector_ms": 0.005330324172973633, "ViewRequirementAgentConnector_ms": 0.12734508514404297}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 907.0, "episode_return_mean": 956.92}, "episode_reward_max": 997.0, "episode_reward_min": 907.0, "episode_reward_mean": 956.92, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [950.0, 963.0, 979.0, 951.0, 963.0, 945.0, 947.0, 952.0, 978.0, 950.0, 949.0, 976.0, 997.0, 964.0, 962.0, 961.0, 967.0, 955.0, 964.0, 926.0, 947.0, 947.0, 959.0, 951.0, 948.0, 939.0, 937.0, 931.0, 974.0, 955.0, 958.0, 977.0, 945.0, 981.0, 941.0, 954.0, 962.0, 958.0, 948.0, 966.0, 932.0, 967.0, 931.0, 971.0, 941.0, 967.0, 964.0, 907.0, 974.0, 966.0, 952.0, 958.0, 943.0, 953.0, 960.0, 969.0, 953.0, 973.0, 968.0, 971.0, 959.0, 940.0, 965.0, 954.0, 939.0, 971.0, 969.0, 963.0, 985.0, 981.0, 946.0, 932.0, 951.0, 935.0, 960.0, 939.0, 949.0, 925.0, 936.0, 954.0, 965.0, 969.0, 948.0, 956.0, 961.0, 963.0, 970.0, 946.0, 953.0, 959.0, 969.0, 970.0, 962.0, 942.0, 978.0, 946.0, 970.0, 961.0, 969.0, 985.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3543377102570357, "mean_inference_ms": 1.766448692039891, "mean_action_processing_ms": 0.13113291986409847, "mean_env_wait_ms": 0.12236354304989325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023486852645874023, "StateBufferConnector_ms": 0.005330324172973633, "ViewRequirementAgentConnector_ms": 0.12734508514404297}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 907.0, "episode_return_mean": 956.92, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.10882447040206, "num_env_steps_trained_throughput_per_sec": 234.10882447040206, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 16981.243, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16981.168, "sample_time_ms": 9564.137, "load_time_ms": 0.432, "load_throughput": 9254480.314, "learn_time_ms": 7408.558, "learn_throughput": 539.916, "synch_weights_time_ms": 7.38}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_00-30-13", "timestamp": 1716103813, "time_this_iter_s": 17.094281911849976, "time_total_s": 135.91567659378052, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 135.91567659378052, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 40.74583333333334, "ram_util_percent": 49.354166666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8758815234066337, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.856111007608394, "policy_loss": -0.04284039861071975, "vf_loss": 19.896508988001013, "vf_explained_var": 0.0005683498356931953, "kl": 0.012212047972930969, "entropy": 0.579237598565317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 988.0, "episode_reward_min": 907.0, "episode_reward_mean": 957.12, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [932.0, 967.0, 931.0, 971.0, 941.0, 967.0, 964.0, 907.0, 974.0, 966.0, 952.0, 958.0, 943.0, 953.0, 960.0, 969.0, 953.0, 973.0, 968.0, 971.0, 959.0, 940.0, 965.0, 954.0, 939.0, 971.0, 969.0, 963.0, 985.0, 981.0, 946.0, 932.0, 951.0, 935.0, 960.0, 939.0, 949.0, 925.0, 936.0, 954.0, 965.0, 969.0, 948.0, 956.0, 961.0, 963.0, 970.0, 946.0, 953.0, 959.0, 969.0, 970.0, 962.0, 942.0, 978.0, 946.0, 970.0, 961.0, 969.0, 985.0, 966.0, 962.0, 933.0, 946.0, 966.0, 952.0, 958.0, 988.0, 917.0, 941.0, 942.0, 982.0, 951.0, 954.0, 955.0, 973.0, 940.0, 950.0, 947.0, 963.0, 958.0, 936.0, 988.0, 952.0, 955.0, 983.0, 953.0, 975.0, 972.0, 961.0, 958.0, 935.0, 941.0, 964.0, 959.0, 963.0, 983.0, 952.0, 952.0, 971.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3539474470287098, "mean_inference_ms": 1.7629637487639855, "mean_action_processing_ms": 0.1309460883432688, "mean_env_wait_ms": 0.12225506740038174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339649200439453, "StateBufferConnector_ms": 0.005300760269165039, "ViewRequirementAgentConnector_ms": 0.12716889381408691}, "num_episodes": 40, "episode_return_max": 988.0, "episode_return_min": 907.0, "episode_return_mean": 957.12}, "env_runner_results": {"episode_reward_max": 988.0, "episode_reward_min": 907.0, "episode_reward_mean": 957.12, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [932.0, 967.0, 931.0, 971.0, 941.0, 967.0, 964.0, 907.0, 974.0, 966.0, 952.0, 958.0, 943.0, 953.0, 960.0, 969.0, 953.0, 973.0, 968.0, 971.0, 959.0, 940.0, 965.0, 954.0, 939.0, 971.0, 969.0, 963.0, 985.0, 981.0, 946.0, 932.0, 951.0, 935.0, 960.0, 939.0, 949.0, 925.0, 936.0, 954.0, 965.0, 969.0, 948.0, 956.0, 961.0, 963.0, 970.0, 946.0, 953.0, 959.0, 969.0, 970.0, 962.0, 942.0, 978.0, 946.0, 970.0, 961.0, 969.0, 985.0, 966.0, 962.0, 933.0, 946.0, 966.0, 952.0, 958.0, 988.0, 917.0, 941.0, 942.0, 982.0, 951.0, 954.0, 955.0, 973.0, 940.0, 950.0, 947.0, 963.0, 958.0, 936.0, 988.0, 952.0, 955.0, 983.0, 953.0, 975.0, 972.0, 961.0, 958.0, 935.0, 941.0, 964.0, 959.0, 963.0, 983.0, 952.0, 952.0, 971.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3539474470287098, "mean_inference_ms": 1.7629637487639855, "mean_action_processing_ms": 0.1309460883432688, "mean_env_wait_ms": 0.12225506740038174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339649200439453, "StateBufferConnector_ms": 0.005300760269165039, "ViewRequirementAgentConnector_ms": 0.12716889381408691}, "num_episodes": 40, "episode_return_max": 988.0, "episode_return_min": 907.0, "episode_return_mean": 957.12}, "episode_reward_max": 988.0, "episode_reward_min": 907.0, "episode_reward_mean": 957.12, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [932.0, 967.0, 931.0, 971.0, 941.0, 967.0, 964.0, 907.0, 974.0, 966.0, 952.0, 958.0, 943.0, 953.0, 960.0, 969.0, 953.0, 973.0, 968.0, 971.0, 959.0, 940.0, 965.0, 954.0, 939.0, 971.0, 969.0, 963.0, 985.0, 981.0, 946.0, 932.0, 951.0, 935.0, 960.0, 939.0, 949.0, 925.0, 936.0, 954.0, 965.0, 969.0, 948.0, 956.0, 961.0, 963.0, 970.0, 946.0, 953.0, 959.0, 969.0, 970.0, 962.0, 942.0, 978.0, 946.0, 970.0, 961.0, 969.0, 985.0, 966.0, 962.0, 933.0, 946.0, 966.0, 952.0, 958.0, 988.0, 917.0, 941.0, 942.0, 982.0, 951.0, 954.0, 955.0, 973.0, 940.0, 950.0, 947.0, 963.0, 958.0, 936.0, 988.0, 952.0, 955.0, 983.0, 953.0, 975.0, 972.0, 961.0, 958.0, 935.0, 941.0, 964.0, 959.0, 963.0, 983.0, 952.0, 952.0, 971.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3539474470287098, "mean_inference_ms": 1.7629637487639855, "mean_action_processing_ms": 0.1309460883432688, "mean_env_wait_ms": 0.12225506740038174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339649200439453, "StateBufferConnector_ms": 0.005300760269165039, "ViewRequirementAgentConnector_ms": 0.12716889381408691}, "num_episodes": 40, "episode_return_max": 988.0, "episode_return_min": 907.0, "episode_return_mean": 957.12, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.3666949822631, "num_env_steps_trained_throughput_per_sec": 238.3666949822631, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 16958.98, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16958.91, "sample_time_ms": 9536.016, "load_time_ms": 0.433, "load_throughput": 9233470.556, "learn_time_ms": 7414.38, "learn_throughput": 539.492, "synch_weights_time_ms": 7.43}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_00-30-30", "timestamp": 1716103830, "time_this_iter_s": 16.789248943328857, "time_total_s": 152.70492553710938, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 152.70492553710938, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.6625, "ram_util_percent": 49.37916666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0403258924843164, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.87612326632264, "policy_loss": -0.04334388437270317, "vf_loss": 19.917062697872037, "vf_explained_var": 0.0007802010223429691, "kl": 0.012022197150870958, "entropy": 0.5680235273735498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 995.0, "episode_reward_min": 902.0, "episode_reward_mean": 958.17, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [965.0, 969.0, 948.0, 956.0, 961.0, 963.0, 970.0, 946.0, 953.0, 959.0, 969.0, 970.0, 962.0, 942.0, 978.0, 946.0, 970.0, 961.0, 969.0, 985.0, 966.0, 962.0, 933.0, 946.0, 966.0, 952.0, 958.0, 988.0, 917.0, 941.0, 942.0, 982.0, 951.0, 954.0, 955.0, 973.0, 940.0, 950.0, 947.0, 963.0, 958.0, 936.0, 988.0, 952.0, 955.0, 983.0, 953.0, 975.0, 972.0, 961.0, 958.0, 935.0, 941.0, 964.0, 959.0, 963.0, 983.0, 952.0, 952.0, 971.0, 970.0, 978.0, 945.0, 947.0, 969.0, 983.0, 933.0, 952.0, 935.0, 983.0, 942.0, 966.0, 941.0, 974.0, 956.0, 965.0, 960.0, 933.0, 956.0, 975.0, 950.0, 939.0, 974.0, 966.0, 960.0, 973.0, 947.0, 946.0, 988.0, 957.0, 939.0, 961.0, 964.0, 972.0, 942.0, 920.0, 902.0, 968.0, 995.0, 952.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3534247445379066, "mean_inference_ms": 1.7592212396307587, "mean_action_processing_ms": 0.13073399303430291, "mean_env_wait_ms": 0.12210929147515831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016929626464844, "StateBufferConnector_ms": 0.0052340030670166016, "ViewRequirementAgentConnector_ms": 0.12549686431884766}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 902.0, "episode_return_mean": 958.17}, "env_runner_results": {"episode_reward_max": 995.0, "episode_reward_min": 902.0, "episode_reward_mean": 958.17, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [965.0, 969.0, 948.0, 956.0, 961.0, 963.0, 970.0, 946.0, 953.0, 959.0, 969.0, 970.0, 962.0, 942.0, 978.0, 946.0, 970.0, 961.0, 969.0, 985.0, 966.0, 962.0, 933.0, 946.0, 966.0, 952.0, 958.0, 988.0, 917.0, 941.0, 942.0, 982.0, 951.0, 954.0, 955.0, 973.0, 940.0, 950.0, 947.0, 963.0, 958.0, 936.0, 988.0, 952.0, 955.0, 983.0, 953.0, 975.0, 972.0, 961.0, 958.0, 935.0, 941.0, 964.0, 959.0, 963.0, 983.0, 952.0, 952.0, 971.0, 970.0, 978.0, 945.0, 947.0, 969.0, 983.0, 933.0, 952.0, 935.0, 983.0, 942.0, 966.0, 941.0, 974.0, 956.0, 965.0, 960.0, 933.0, 956.0, 975.0, 950.0, 939.0, 974.0, 966.0, 960.0, 973.0, 947.0, 946.0, 988.0, 957.0, 939.0, 961.0, 964.0, 972.0, 942.0, 920.0, 902.0, 968.0, 995.0, 952.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3534247445379066, "mean_inference_ms": 1.7592212396307587, "mean_action_processing_ms": 0.13073399303430291, "mean_env_wait_ms": 0.12210929147515831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016929626464844, "StateBufferConnector_ms": 0.0052340030670166016, "ViewRequirementAgentConnector_ms": 0.12549686431884766}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 902.0, "episode_return_mean": 958.17}, "episode_reward_max": 995.0, "episode_reward_min": 902.0, "episode_reward_mean": 958.17, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [965.0, 969.0, 948.0, 956.0, 961.0, 963.0, 970.0, 946.0, 953.0, 959.0, 969.0, 970.0, 962.0, 942.0, 978.0, 946.0, 970.0, 961.0, 969.0, 985.0, 966.0, 962.0, 933.0, 946.0, 966.0, 952.0, 958.0, 988.0, 917.0, 941.0, 942.0, 982.0, 951.0, 954.0, 955.0, 973.0, 940.0, 950.0, 947.0, 963.0, 958.0, 936.0, 988.0, 952.0, 955.0, 983.0, 953.0, 975.0, 972.0, 961.0, 958.0, 935.0, 941.0, 964.0, 959.0, 963.0, 983.0, 952.0, 952.0, 971.0, 970.0, 978.0, 945.0, 947.0, 969.0, 983.0, 933.0, 952.0, 935.0, 983.0, 942.0, 966.0, 941.0, 974.0, 956.0, 965.0, 960.0, 933.0, 956.0, 975.0, 950.0, 939.0, 974.0, 966.0, 960.0, 973.0, 947.0, 946.0, 988.0, 957.0, 939.0, 961.0, 964.0, 972.0, 942.0, 920.0, 902.0, 968.0, 995.0, 952.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3534247445379066, "mean_inference_ms": 1.7592212396307587, "mean_action_processing_ms": 0.13073399303430291, "mean_env_wait_ms": 0.12210929147515831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016929626464844, "StateBufferConnector_ms": 0.0052340030670166016, "ViewRequirementAgentConnector_ms": 0.12549686431884766}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 902.0, "episode_return_mean": 958.17, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.4995135097361, "num_env_steps_trained_throughput_per_sec": 240.4995135097361, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 16926.288, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16926.221, "sample_time_ms": 9514.403, "load_time_ms": 0.433, "load_throughput": 9242626.708, "learn_time_ms": 7403.405, "learn_throughput": 540.292, "synch_weights_time_ms": 7.337}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_00-30-47", "timestamp": 1716103847, "time_this_iter_s": 16.640074014663696, "time_total_s": 169.34499955177307, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 169.34499955177307, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 38.141666666666666, "ram_util_percent": 49.34583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.206045370204474, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.860515009972357, "policy_loss": -0.04773924961956518, "vf_loss": 19.905716461263676, "vf_explained_var": 0.0006321775656874461, "kl": 0.012688643984439115, "entropy": 0.5644397788150336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 995.0, "episode_reward_min": 902.0, "episode_reward_mean": 957.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [958.0, 936.0, 988.0, 952.0, 955.0, 983.0, 953.0, 975.0, 972.0, 961.0, 958.0, 935.0, 941.0, 964.0, 959.0, 963.0, 983.0, 952.0, 952.0, 971.0, 970.0, 978.0, 945.0, 947.0, 969.0, 983.0, 933.0, 952.0, 935.0, 983.0, 942.0, 966.0, 941.0, 974.0, 956.0, 965.0, 960.0, 933.0, 956.0, 975.0, 950.0, 939.0, 974.0, 966.0, 960.0, 973.0, 947.0, 946.0, 988.0, 957.0, 939.0, 961.0, 964.0, 972.0, 942.0, 920.0, 902.0, 968.0, 995.0, 952.0, 936.0, 954.0, 939.0, 970.0, 971.0, 957.0, 959.0, 947.0, 937.0, 938.0, 950.0, 969.0, 971.0, 976.0, 934.0, 980.0, 991.0, 955.0, 958.0, 976.0, 959.0, 935.0, 960.0, 935.0, 971.0, 959.0, 970.0, 963.0, 968.0, 969.0, 950.0, 964.0, 959.0, 976.0, 928.0, 930.0, 948.0, 957.0, 967.0, 967.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3527988818127181, "mean_inference_ms": 1.7550935424712726, "mean_action_processing_ms": 0.13048224600340216, "mean_env_wait_ms": 0.1219205677179178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023018836975097656, "StateBufferConnector_ms": 0.005277395248413086, "ViewRequirementAgentConnector_ms": 0.12522077560424805}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 902.0, "episode_return_mean": 957.92}, "env_runner_results": {"episode_reward_max": 995.0, "episode_reward_min": 902.0, "episode_reward_mean": 957.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [958.0, 936.0, 988.0, 952.0, 955.0, 983.0, 953.0, 975.0, 972.0, 961.0, 958.0, 935.0, 941.0, 964.0, 959.0, 963.0, 983.0, 952.0, 952.0, 971.0, 970.0, 978.0, 945.0, 947.0, 969.0, 983.0, 933.0, 952.0, 935.0, 983.0, 942.0, 966.0, 941.0, 974.0, 956.0, 965.0, 960.0, 933.0, 956.0, 975.0, 950.0, 939.0, 974.0, 966.0, 960.0, 973.0, 947.0, 946.0, 988.0, 957.0, 939.0, 961.0, 964.0, 972.0, 942.0, 920.0, 902.0, 968.0, 995.0, 952.0, 936.0, 954.0, 939.0, 970.0, 971.0, 957.0, 959.0, 947.0, 937.0, 938.0, 950.0, 969.0, 971.0, 976.0, 934.0, 980.0, 991.0, 955.0, 958.0, 976.0, 959.0, 935.0, 960.0, 935.0, 971.0, 959.0, 970.0, 963.0, 968.0, 969.0, 950.0, 964.0, 959.0, 976.0, 928.0, 930.0, 948.0, 957.0, 967.0, 967.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3527988818127181, "mean_inference_ms": 1.7550935424712726, "mean_action_processing_ms": 0.13048224600340216, "mean_env_wait_ms": 0.1219205677179178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023018836975097656, "StateBufferConnector_ms": 0.005277395248413086, "ViewRequirementAgentConnector_ms": 0.12522077560424805}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 902.0, "episode_return_mean": 957.92}, "episode_reward_max": 995.0, "episode_reward_min": 902.0, "episode_reward_mean": 957.92, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [958.0, 936.0, 988.0, 952.0, 955.0, 983.0, 953.0, 975.0, 972.0, 961.0, 958.0, 935.0, 941.0, 964.0, 959.0, 963.0, 983.0, 952.0, 952.0, 971.0, 970.0, 978.0, 945.0, 947.0, 969.0, 983.0, 933.0, 952.0, 935.0, 983.0, 942.0, 966.0, 941.0, 974.0, 956.0, 965.0, 960.0, 933.0, 956.0, 975.0, 950.0, 939.0, 974.0, 966.0, 960.0, 973.0, 947.0, 946.0, 988.0, 957.0, 939.0, 961.0, 964.0, 972.0, 942.0, 920.0, 902.0, 968.0, 995.0, 952.0, 936.0, 954.0, 939.0, 970.0, 971.0, 957.0, 959.0, 947.0, 937.0, 938.0, 950.0, 969.0, 971.0, 976.0, 934.0, 980.0, 991.0, 955.0, 958.0, 976.0, 959.0, 935.0, 960.0, 935.0, 971.0, 959.0, 970.0, 963.0, 968.0, 969.0, 950.0, 964.0, 959.0, 976.0, 928.0, 930.0, 948.0, 957.0, 967.0, 967.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3527988818127181, "mean_inference_ms": 1.7550935424712726, "mean_action_processing_ms": 0.13048224600340216, "mean_env_wait_ms": 0.1219205677179178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023018836975097656, "StateBufferConnector_ms": 0.005277395248413086, "ViewRequirementAgentConnector_ms": 0.12522077560424805}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 902.0, "episode_return_mean": 957.92, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.25200523585258, "num_env_steps_trained_throughput_per_sec": 237.25200523585258, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 16874.273, "restore_workers_time_ms": 0.016, "training_step_time_ms": 16874.214, "sample_time_ms": 9490.223, "load_time_ms": 0.447, "load_throughput": 8944986.138, "learn_time_ms": 7375.649, "learn_throughput": 542.325, "synch_weights_time_ms": 7.304}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 440, "training_iteration": 11, "trial_id": "default", "date": "2024-05-19_00-31-04", "timestamp": 1716103864, "time_this_iter_s": 16.868654012680054, "time_total_s": 186.21365356445312, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 186.21365356445312, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.983333333333334, "ram_util_percent": 49.37083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.073858029227103, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.839133488234655, "policy_loss": -0.04612370300236889, "vf_loss": 19.882632142754012, "vf_explained_var": 0.0006934849805729364, "kl": 0.013124947990189272, "entropy": 0.5537596119347439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 995.0, "episode_reward_min": 902.0, "episode_reward_mean": 958.02, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 939.0, 974.0, 966.0, 960.0, 973.0, 947.0, 946.0, 988.0, 957.0, 939.0, 961.0, 964.0, 972.0, 942.0, 920.0, 902.0, 968.0, 995.0, 952.0, 936.0, 954.0, 939.0, 970.0, 971.0, 957.0, 959.0, 947.0, 937.0, 938.0, 950.0, 969.0, 971.0, 976.0, 934.0, 980.0, 991.0, 955.0, 958.0, 976.0, 959.0, 935.0, 960.0, 935.0, 971.0, 959.0, 970.0, 963.0, 968.0, 969.0, 950.0, 964.0, 959.0, 976.0, 928.0, 930.0, 948.0, 957.0, 967.0, 967.0, 933.0, 965.0, 941.0, 985.0, 949.0, 979.0, 990.0, 964.0, 948.0, 957.0, 953.0, 953.0, 935.0, 953.0, 942.0, 957.0, 970.0, 965.0, 931.0, 971.0, 991.0, 963.0, 974.0, 947.0, 971.0, 995.0, 984.0, 947.0, 983.0, 952.0, 965.0, 982.0, 970.0, 948.0, 914.0, 945.0, 943.0, 949.0, 951.0, 969.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3522883032851209, "mean_inference_ms": 1.7517630005105553, "mean_action_processing_ms": 0.1302842944087754, "mean_env_wait_ms": 0.12176434348252059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02309703826904297, "StateBufferConnector_ms": 0.005274772644042969, "ViewRequirementAgentConnector_ms": 0.12538719177246094}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 902.0, "episode_return_mean": 958.02}, "env_runner_results": {"episode_reward_max": 995.0, "episode_reward_min": 902.0, "episode_reward_mean": 958.02, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 939.0, 974.0, 966.0, 960.0, 973.0, 947.0, 946.0, 988.0, 957.0, 939.0, 961.0, 964.0, 972.0, 942.0, 920.0, 902.0, 968.0, 995.0, 952.0, 936.0, 954.0, 939.0, 970.0, 971.0, 957.0, 959.0, 947.0, 937.0, 938.0, 950.0, 969.0, 971.0, 976.0, 934.0, 980.0, 991.0, 955.0, 958.0, 976.0, 959.0, 935.0, 960.0, 935.0, 971.0, 959.0, 970.0, 963.0, 968.0, 969.0, 950.0, 964.0, 959.0, 976.0, 928.0, 930.0, 948.0, 957.0, 967.0, 967.0, 933.0, 965.0, 941.0, 985.0, 949.0, 979.0, 990.0, 964.0, 948.0, 957.0, 953.0, 953.0, 935.0, 953.0, 942.0, 957.0, 970.0, 965.0, 931.0, 971.0, 991.0, 963.0, 974.0, 947.0, 971.0, 995.0, 984.0, 947.0, 983.0, 952.0, 965.0, 982.0, 970.0, 948.0, 914.0, 945.0, 943.0, 949.0, 951.0, 969.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3522883032851209, "mean_inference_ms": 1.7517630005105553, "mean_action_processing_ms": 0.1302842944087754, "mean_env_wait_ms": 0.12176434348252059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02309703826904297, "StateBufferConnector_ms": 0.005274772644042969, "ViewRequirementAgentConnector_ms": 0.12538719177246094}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 902.0, "episode_return_mean": 958.02}, "episode_reward_max": 995.0, "episode_reward_min": 902.0, "episode_reward_mean": 958.02, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [950.0, 939.0, 974.0, 966.0, 960.0, 973.0, 947.0, 946.0, 988.0, 957.0, 939.0, 961.0, 964.0, 972.0, 942.0, 920.0, 902.0, 968.0, 995.0, 952.0, 936.0, 954.0, 939.0, 970.0, 971.0, 957.0, 959.0, 947.0, 937.0, 938.0, 950.0, 969.0, 971.0, 976.0, 934.0, 980.0, 991.0, 955.0, 958.0, 976.0, 959.0, 935.0, 960.0, 935.0, 971.0, 959.0, 970.0, 963.0, 968.0, 969.0, 950.0, 964.0, 959.0, 976.0, 928.0, 930.0, 948.0, 957.0, 967.0, 967.0, 933.0, 965.0, 941.0, 985.0, 949.0, 979.0, 990.0, 964.0, 948.0, 957.0, 953.0, 953.0, 935.0, 953.0, 942.0, 957.0, 970.0, 965.0, 931.0, 971.0, 991.0, 963.0, 974.0, 947.0, 971.0, 995.0, 984.0, 947.0, 983.0, 952.0, 965.0, 982.0, 970.0, 948.0, 914.0, 945.0, 943.0, 949.0, 951.0, 969.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3522883032851209, "mean_inference_ms": 1.7517630005105553, "mean_action_processing_ms": 0.1302842944087754, "mean_env_wait_ms": 0.12176434348252059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02309703826904297, "StateBufferConnector_ms": 0.005274772644042969, "ViewRequirementAgentConnector_ms": 0.12538719177246094}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 902.0, "episode_return_mean": 958.02, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.85921616183958, "num_env_steps_trained_throughput_per_sec": 239.85921616183958, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 16770.218, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16770.161, "sample_time_ms": 9385.013, "load_time_ms": 0.449, "load_throughput": 8904631.389, "learn_time_ms": 7376.961, "learn_throughput": 542.229, "synch_weights_time_ms": 7.152}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 480, "training_iteration": 12, "trial_id": "default", "date": "2024-05-19_00-31-21", "timestamp": 1716103881, "time_this_iter_s": 16.684798002243042, "time_total_s": 202.89845156669617, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 202.89845156669617, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 38.275, "ram_util_percent": 49.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.296120632463886, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.832862503297868, "policy_loss": -0.04450810238698958, "vf_loss": 19.874780548259775, "vf_explained_var": 0.0008513748004872312, "kl": 0.012950549535348724, "entropy": 0.5358386752746438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 995.0, "episode_reward_min": 914.0, "episode_reward_mean": 957.97, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [959.0, 935.0, 960.0, 935.0, 971.0, 959.0, 970.0, 963.0, 968.0, 969.0, 950.0, 964.0, 959.0, 976.0, 928.0, 930.0, 948.0, 957.0, 967.0, 967.0, 933.0, 965.0, 941.0, 985.0, 949.0, 979.0, 990.0, 964.0, 948.0, 957.0, 953.0, 953.0, 935.0, 953.0, 942.0, 957.0, 970.0, 965.0, 931.0, 971.0, 991.0, 963.0, 974.0, 947.0, 971.0, 995.0, 984.0, 947.0, 983.0, 952.0, 965.0, 982.0, 970.0, 948.0, 914.0, 945.0, 943.0, 949.0, 951.0, 969.0, 934.0, 968.0, 973.0, 980.0, 972.0, 949.0, 936.0, 981.0, 954.0, 957.0, 964.0, 960.0, 974.0, 932.0, 947.0, 940.0, 971.0, 948.0, 958.0, 985.0, 934.0, 970.0, 955.0, 951.0, 951.0, 969.0, 965.0, 953.0, 973.0, 943.0, 962.0, 960.0, 928.0, 931.0, 960.0, 989.0, 949.0, 967.0, 926.0, 959.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35186509650048525, "mean_inference_ms": 1.7488435982263615, "mean_action_processing_ms": 0.13010956662437168, "mean_env_wait_ms": 0.12162458993198393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02366161346435547, "StateBufferConnector_ms": 0.00548100471496582, "ViewRequirementAgentConnector_ms": 0.12545537948608398}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 914.0, "episode_return_mean": 957.97}, "env_runner_results": {"episode_reward_max": 995.0, "episode_reward_min": 914.0, "episode_reward_mean": 957.97, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [959.0, 935.0, 960.0, 935.0, 971.0, 959.0, 970.0, 963.0, 968.0, 969.0, 950.0, 964.0, 959.0, 976.0, 928.0, 930.0, 948.0, 957.0, 967.0, 967.0, 933.0, 965.0, 941.0, 985.0, 949.0, 979.0, 990.0, 964.0, 948.0, 957.0, 953.0, 953.0, 935.0, 953.0, 942.0, 957.0, 970.0, 965.0, 931.0, 971.0, 991.0, 963.0, 974.0, 947.0, 971.0, 995.0, 984.0, 947.0, 983.0, 952.0, 965.0, 982.0, 970.0, 948.0, 914.0, 945.0, 943.0, 949.0, 951.0, 969.0, 934.0, 968.0, 973.0, 980.0, 972.0, 949.0, 936.0, 981.0, 954.0, 957.0, 964.0, 960.0, 974.0, 932.0, 947.0, 940.0, 971.0, 948.0, 958.0, 985.0, 934.0, 970.0, 955.0, 951.0, 951.0, 969.0, 965.0, 953.0, 973.0, 943.0, 962.0, 960.0, 928.0, 931.0, 960.0, 989.0, 949.0, 967.0, 926.0, 959.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35186509650048525, "mean_inference_ms": 1.7488435982263615, "mean_action_processing_ms": 0.13010956662437168, "mean_env_wait_ms": 0.12162458993198393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02366161346435547, "StateBufferConnector_ms": 0.00548100471496582, "ViewRequirementAgentConnector_ms": 0.12545537948608398}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 914.0, "episode_return_mean": 957.97}, "episode_reward_max": 995.0, "episode_reward_min": 914.0, "episode_reward_mean": 957.97, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [959.0, 935.0, 960.0, 935.0, 971.0, 959.0, 970.0, 963.0, 968.0, 969.0, 950.0, 964.0, 959.0, 976.0, 928.0, 930.0, 948.0, 957.0, 967.0, 967.0, 933.0, 965.0, 941.0, 985.0, 949.0, 979.0, 990.0, 964.0, 948.0, 957.0, 953.0, 953.0, 935.0, 953.0, 942.0, 957.0, 970.0, 965.0, 931.0, 971.0, 991.0, 963.0, 974.0, 947.0, 971.0, 995.0, 984.0, 947.0, 983.0, 952.0, 965.0, 982.0, 970.0, 948.0, 914.0, 945.0, 943.0, 949.0, 951.0, 969.0, 934.0, 968.0, 973.0, 980.0, 972.0, 949.0, 936.0, 981.0, 954.0, 957.0, 964.0, 960.0, 974.0, 932.0, 947.0, 940.0, 971.0, 948.0, 958.0, 985.0, 934.0, 970.0, 955.0, 951.0, 951.0, 969.0, 965.0, 953.0, 973.0, 943.0, 962.0, 960.0, 928.0, 931.0, 960.0, 989.0, 949.0, 967.0, 926.0, 959.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35186509650048525, "mean_inference_ms": 1.7488435982263615, "mean_action_processing_ms": 0.13010956662437168, "mean_env_wait_ms": 0.12162458993198393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02366161346435547, "StateBufferConnector_ms": 0.00548100471496582, "ViewRequirementAgentConnector_ms": 0.12545537948608398}, "num_episodes": 40, "episode_return_max": 995.0, "episode_return_min": 914.0, "episode_return_mean": 957.97, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.53671815192988, "num_env_steps_trained_throughput_per_sec": 240.53671815192988, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 16769.842, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16769.787, "sample_time_ms": 9385.336, "load_time_ms": 0.451, "load_throughput": 8868856.584, "learn_time_ms": 7376.14, "learn_throughput": 542.289, "synch_weights_time_ms": 7.278}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 520, "training_iteration": 13, "trial_id": "default", "date": "2024-05-19_00-31-37", "timestamp": 1716103897, "time_this_iter_s": 16.638098001480103, "time_total_s": 219.53654956817627, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 219.53654956817627, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.53478260869565, "ram_util_percent": 49.39565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6140670644339696, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.849649189364527, "policy_loss": -0.04871986093680544, "vf_loss": 19.895608727649975, "vf_explained_var": 0.0007359666849977226, "kl": 0.013801882049906001, "entropy": 0.5284372832826388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": 914.0, "episode_reward_mean": 958.89, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [991.0, 963.0, 974.0, 947.0, 971.0, 995.0, 984.0, 947.0, 983.0, 952.0, 965.0, 982.0, 970.0, 948.0, 914.0, 945.0, 943.0, 949.0, 951.0, 969.0, 934.0, 968.0, 973.0, 980.0, 972.0, 949.0, 936.0, 981.0, 954.0, 957.0, 964.0, 960.0, 974.0, 932.0, 947.0, 940.0, 971.0, 948.0, 958.0, 985.0, 934.0, 970.0, 955.0, 951.0, 951.0, 969.0, 965.0, 953.0, 973.0, 943.0, 962.0, 960.0, 928.0, 931.0, 960.0, 989.0, 949.0, 967.0, 926.0, 959.0, 981.0, 978.0, 964.0, 950.0, 946.0, 952.0, 947.0, 977.0, 970.0, 952.0, 937.0, 945.0, 940.0, 945.0, 953.0, 982.0, 942.0, 960.0, 954.0, 956.0, 940.0, 952.0, 975.0, 919.0, 954.0, 974.0, 965.0, 955.0, 974.0, 997.0, 937.0, 948.0, 952.0, 991.0, 964.0, 960.0, 957.0, 979.0, 972.0, 972.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3520187870956233, "mean_inference_ms": 1.7487382130603266, "mean_action_processing_ms": 0.13011266480294917, "mean_env_wait_ms": 0.12164305342217817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02386307716369629, "StateBufferConnector_ms": 0.005459308624267578, "ViewRequirementAgentConnector_ms": 0.12720870971679688}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 914.0, "episode_return_mean": 958.89}, "env_runner_results": {"episode_reward_max": 997.0, "episode_reward_min": 914.0, "episode_reward_mean": 958.89, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [991.0, 963.0, 974.0, 947.0, 971.0, 995.0, 984.0, 947.0, 983.0, 952.0, 965.0, 982.0, 970.0, 948.0, 914.0, 945.0, 943.0, 949.0, 951.0, 969.0, 934.0, 968.0, 973.0, 980.0, 972.0, 949.0, 936.0, 981.0, 954.0, 957.0, 964.0, 960.0, 974.0, 932.0, 947.0, 940.0, 971.0, 948.0, 958.0, 985.0, 934.0, 970.0, 955.0, 951.0, 951.0, 969.0, 965.0, 953.0, 973.0, 943.0, 962.0, 960.0, 928.0, 931.0, 960.0, 989.0, 949.0, 967.0, 926.0, 959.0, 981.0, 978.0, 964.0, 950.0, 946.0, 952.0, 947.0, 977.0, 970.0, 952.0, 937.0, 945.0, 940.0, 945.0, 953.0, 982.0, 942.0, 960.0, 954.0, 956.0, 940.0, 952.0, 975.0, 919.0, 954.0, 974.0, 965.0, 955.0, 974.0, 997.0, 937.0, 948.0, 952.0, 991.0, 964.0, 960.0, 957.0, 979.0, 972.0, 972.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3520187870956233, "mean_inference_ms": 1.7487382130603266, "mean_action_processing_ms": 0.13011266480294917, "mean_env_wait_ms": 0.12164305342217817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02386307716369629, "StateBufferConnector_ms": 0.005459308624267578, "ViewRequirementAgentConnector_ms": 0.12720870971679688}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 914.0, "episode_return_mean": 958.89}, "episode_reward_max": 997.0, "episode_reward_min": 914.0, "episode_reward_mean": 958.89, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [991.0, 963.0, 974.0, 947.0, 971.0, 995.0, 984.0, 947.0, 983.0, 952.0, 965.0, 982.0, 970.0, 948.0, 914.0, 945.0, 943.0, 949.0, 951.0, 969.0, 934.0, 968.0, 973.0, 980.0, 972.0, 949.0, 936.0, 981.0, 954.0, 957.0, 964.0, 960.0, 974.0, 932.0, 947.0, 940.0, 971.0, 948.0, 958.0, 985.0, 934.0, 970.0, 955.0, 951.0, 951.0, 969.0, 965.0, 953.0, 973.0, 943.0, 962.0, 960.0, 928.0, 931.0, 960.0, 989.0, 949.0, 967.0, 926.0, 959.0, 981.0, 978.0, 964.0, 950.0, 946.0, 952.0, 947.0, 977.0, 970.0, 952.0, 937.0, 945.0, 940.0, 945.0, 953.0, 982.0, 942.0, 960.0, 954.0, 956.0, 940.0, 952.0, 975.0, 919.0, 954.0, 974.0, 965.0, 955.0, 974.0, 997.0, 937.0, 948.0, 952.0, 991.0, 964.0, 960.0, 957.0, 979.0, 972.0, 972.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3520187870956233, "mean_inference_ms": 1.7487382130603266, "mean_action_processing_ms": 0.13011266480294917, "mean_env_wait_ms": 0.12164305342217817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02386307716369629, "StateBufferConnector_ms": 0.005459308624267578, "ViewRequirementAgentConnector_ms": 0.12720870971679688}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 914.0, "episode_return_mean": 958.89, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.62066202149495, "num_env_steps_trained_throughput_per_sec": 233.62066202149495, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 16799.981, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16799.927, "sample_time_ms": 9412.605, "load_time_ms": 0.448, "load_throughput": 8935933.955, "learn_time_ms": 7379.156, "learn_throughput": 542.067, "synch_weights_time_ms": 7.137}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 560, "training_iteration": 14, "trial_id": "default", "date": "2024-05-19_00-31-54", "timestamp": 1716103914, "time_this_iter_s": 17.129825830459595, "time_total_s": 236.66637539863586, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 236.66637539863586, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 40.111999999999995, "ram_util_percent": 49.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5186994892294687, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.775172703240507, "policy_loss": -0.04803626471229138, "vf_loss": 19.820395443003665, "vf_explained_var": 0.0008975057832656369, "kl": 0.014067483628070719, "entropy": 0.5072478640784499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": 914.0, "episode_reward_mean": 955.14, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [934.0, 970.0, 955.0, 951.0, 951.0, 969.0, 965.0, 953.0, 973.0, 943.0, 962.0, 960.0, 928.0, 931.0, 960.0, 989.0, 949.0, 967.0, 926.0, 959.0, 981.0, 978.0, 964.0, 950.0, 946.0, 952.0, 947.0, 977.0, 970.0, 952.0, 937.0, 945.0, 940.0, 945.0, 953.0, 982.0, 942.0, 960.0, 954.0, 956.0, 940.0, 952.0, 975.0, 919.0, 954.0, 974.0, 965.0, 955.0, 974.0, 997.0, 937.0, 948.0, 952.0, 991.0, 964.0, 960.0, 957.0, 979.0, 972.0, 972.0, 962.0, 962.0, 949.0, 958.0, 958.0, 957.0, 947.0, 928.0, 920.0, 946.0, 979.0, 932.0, 973.0, 952.0, 952.0, 962.0, 952.0, 939.0, 952.0, 926.0, 950.0, 946.0, 982.0, 942.0, 958.0, 949.0, 941.0, 980.0, 939.0, 956.0, 940.0, 914.0, 935.0, 968.0, 970.0, 965.0, 926.0, 958.0, 978.0, 948.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35218486146315064, "mean_inference_ms": 1.748880305620431, "mean_action_processing_ms": 0.13013630687606068, "mean_env_wait_ms": 0.12167193269929162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023900747299194336, "StateBufferConnector_ms": 0.005475759506225586, "ViewRequirementAgentConnector_ms": 0.12741518020629883}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 914.0, "episode_return_mean": 955.14}, "env_runner_results": {"episode_reward_max": 997.0, "episode_reward_min": 914.0, "episode_reward_mean": 955.14, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [934.0, 970.0, 955.0, 951.0, 951.0, 969.0, 965.0, 953.0, 973.0, 943.0, 962.0, 960.0, 928.0, 931.0, 960.0, 989.0, 949.0, 967.0, 926.0, 959.0, 981.0, 978.0, 964.0, 950.0, 946.0, 952.0, 947.0, 977.0, 970.0, 952.0, 937.0, 945.0, 940.0, 945.0, 953.0, 982.0, 942.0, 960.0, 954.0, 956.0, 940.0, 952.0, 975.0, 919.0, 954.0, 974.0, 965.0, 955.0, 974.0, 997.0, 937.0, 948.0, 952.0, 991.0, 964.0, 960.0, 957.0, 979.0, 972.0, 972.0, 962.0, 962.0, 949.0, 958.0, 958.0, 957.0, 947.0, 928.0, 920.0, 946.0, 979.0, 932.0, 973.0, 952.0, 952.0, 962.0, 952.0, 939.0, 952.0, 926.0, 950.0, 946.0, 982.0, 942.0, 958.0, 949.0, 941.0, 980.0, 939.0, 956.0, 940.0, 914.0, 935.0, 968.0, 970.0, 965.0, 926.0, 958.0, 978.0, 948.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35218486146315064, "mean_inference_ms": 1.748880305620431, "mean_action_processing_ms": 0.13013630687606068, "mean_env_wait_ms": 0.12167193269929162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023900747299194336, "StateBufferConnector_ms": 0.005475759506225586, "ViewRequirementAgentConnector_ms": 0.12741518020629883}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 914.0, "episode_return_mean": 955.14}, "episode_reward_max": 997.0, "episode_reward_min": 914.0, "episode_reward_mean": 955.14, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [934.0, 970.0, 955.0, 951.0, 951.0, 969.0, 965.0, 953.0, 973.0, 943.0, 962.0, 960.0, 928.0, 931.0, 960.0, 989.0, 949.0, 967.0, 926.0, 959.0, 981.0, 978.0, 964.0, 950.0, 946.0, 952.0, 947.0, 977.0, 970.0, 952.0, 937.0, 945.0, 940.0, 945.0, 953.0, 982.0, 942.0, 960.0, 954.0, 956.0, 940.0, 952.0, 975.0, 919.0, 954.0, 974.0, 965.0, 955.0, 974.0, 997.0, 937.0, 948.0, 952.0, 991.0, 964.0, 960.0, 957.0, 979.0, 972.0, 972.0, 962.0, 962.0, 949.0, 958.0, 958.0, 957.0, 947.0, 928.0, 920.0, 946.0, 979.0, 932.0, 973.0, 952.0, 952.0, 962.0, 952.0, 939.0, 952.0, 926.0, 950.0, 946.0, 982.0, 942.0, 958.0, 949.0, 941.0, 980.0, 939.0, 956.0, 940.0, 914.0, 935.0, 968.0, 970.0, 965.0, 926.0, 958.0, 978.0, 948.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35218486146315064, "mean_inference_ms": 1.748880305620431, "mean_action_processing_ms": 0.13013630687606068, "mean_env_wait_ms": 0.12167193269929162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023900747299194336, "StateBufferConnector_ms": 0.005475759506225586, "ViewRequirementAgentConnector_ms": 0.12741518020629883}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 914.0, "episode_return_mean": 955.14, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.4142207601491, "num_env_steps_trained_throughput_per_sec": 240.4142207601491, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 16790.608, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16790.555, "sample_time_ms": 9408.43, "load_time_ms": 0.446, "load_throughput": 8966498.851, "learn_time_ms": 7373.822, "learn_throughput": 542.46, "synch_weights_time_ms": 7.28}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 600, "training_iteration": 15, "trial_id": "default", "date": "2024-05-19_00-32-11", "timestamp": 1716103931, "time_this_iter_s": 16.646334171295166, "time_total_s": 253.31270956993103, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 253.31270956993103, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.54347826086956, "ram_util_percent": 49.41304347826086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7087731712607925, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.805873085350118, "policy_loss": -0.044803835677423624, "vf_loss": 19.848069609365155, "vf_explained_var": 0.0007734653129372545, "kl": 0.013036511426091824, "entropy": 0.5032469967360138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": 914.0, "episode_reward_mean": 956.2, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 952.0, 975.0, 919.0, 954.0, 974.0, 965.0, 955.0, 974.0, 997.0, 937.0, 948.0, 952.0, 991.0, 964.0, 960.0, 957.0, 979.0, 972.0, 972.0, 962.0, 962.0, 949.0, 958.0, 958.0, 957.0, 947.0, 928.0, 920.0, 946.0, 979.0, 932.0, 973.0, 952.0, 952.0, 962.0, 952.0, 939.0, 952.0, 926.0, 950.0, 946.0, 982.0, 942.0, 958.0, 949.0, 941.0, 980.0, 939.0, 956.0, 940.0, 914.0, 935.0, 968.0, 970.0, 965.0, 926.0, 958.0, 978.0, 948.0, 942.0, 945.0, 956.0, 950.0, 959.0, 992.0, 958.0, 961.0, 940.0, 952.0, 964.0, 980.0, 951.0, 947.0, 954.0, 964.0, 960.0, 922.0, 966.0, 960.0, 958.0, 961.0, 955.0, 958.0, 915.0, 984.0, 964.0, 959.0, 973.0, 966.0, 950.0, 947.0, 949.0, 966.0, 968.0, 962.0, 966.0, 971.0, 977.0, 960.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3521072845421761, "mean_inference_ms": 1.7479959631810897, "mean_action_processing_ms": 0.1300945585130518, "mean_env_wait_ms": 0.1216410749772811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02316594123840332, "StateBufferConnector_ms": 0.005272865295410156, "ViewRequirementAgentConnector_ms": 0.12706780433654785}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 914.0, "episode_return_mean": 956.2}, "env_runner_results": {"episode_reward_max": 997.0, "episode_reward_min": 914.0, "episode_reward_mean": 956.2, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 952.0, 975.0, 919.0, 954.0, 974.0, 965.0, 955.0, 974.0, 997.0, 937.0, 948.0, 952.0, 991.0, 964.0, 960.0, 957.0, 979.0, 972.0, 972.0, 962.0, 962.0, 949.0, 958.0, 958.0, 957.0, 947.0, 928.0, 920.0, 946.0, 979.0, 932.0, 973.0, 952.0, 952.0, 962.0, 952.0, 939.0, 952.0, 926.0, 950.0, 946.0, 982.0, 942.0, 958.0, 949.0, 941.0, 980.0, 939.0, 956.0, 940.0, 914.0, 935.0, 968.0, 970.0, 965.0, 926.0, 958.0, 978.0, 948.0, 942.0, 945.0, 956.0, 950.0, 959.0, 992.0, 958.0, 961.0, 940.0, 952.0, 964.0, 980.0, 951.0, 947.0, 954.0, 964.0, 960.0, 922.0, 966.0, 960.0, 958.0, 961.0, 955.0, 958.0, 915.0, 984.0, 964.0, 959.0, 973.0, 966.0, 950.0, 947.0, 949.0, 966.0, 968.0, 962.0, 966.0, 971.0, 977.0, 960.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3521072845421761, "mean_inference_ms": 1.7479959631810897, "mean_action_processing_ms": 0.1300945585130518, "mean_env_wait_ms": 0.1216410749772811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02316594123840332, "StateBufferConnector_ms": 0.005272865295410156, "ViewRequirementAgentConnector_ms": 0.12706780433654785}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 914.0, "episode_return_mean": 956.2}, "episode_reward_max": 997.0, "episode_reward_min": 914.0, "episode_reward_mean": 956.2, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [940.0, 952.0, 975.0, 919.0, 954.0, 974.0, 965.0, 955.0, 974.0, 997.0, 937.0, 948.0, 952.0, 991.0, 964.0, 960.0, 957.0, 979.0, 972.0, 972.0, 962.0, 962.0, 949.0, 958.0, 958.0, 957.0, 947.0, 928.0, 920.0, 946.0, 979.0, 932.0, 973.0, 952.0, 952.0, 962.0, 952.0, 939.0, 952.0, 926.0, 950.0, 946.0, 982.0, 942.0, 958.0, 949.0, 941.0, 980.0, 939.0, 956.0, 940.0, 914.0, 935.0, 968.0, 970.0, 965.0, 926.0, 958.0, 978.0, 948.0, 942.0, 945.0, 956.0, 950.0, 959.0, 992.0, 958.0, 961.0, 940.0, 952.0, 964.0, 980.0, 951.0, 947.0, 954.0, 964.0, 960.0, 922.0, 966.0, 960.0, 958.0, 961.0, 955.0, 958.0, 915.0, 984.0, 964.0, 959.0, 973.0, 966.0, 950.0, 947.0, 949.0, 966.0, 968.0, 962.0, 966.0, 971.0, 977.0, 960.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3521072845421761, "mean_inference_ms": 1.7479959631810897, "mean_action_processing_ms": 0.1300945585130518, "mean_env_wait_ms": 0.1216410749772811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02316594123840332, "StateBufferConnector_ms": 0.005272865295410156, "ViewRequirementAgentConnector_ms": 0.12706780433654785}, "num_episodes": 40, "episode_return_max": 997.0, "episode_return_min": 914.0, "episode_return_mean": 956.2, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.23191754021377, "num_env_steps_trained_throughput_per_sec": 240.23191754021377, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 16787.171, "restore_workers_time_ms": 0.013, "training_step_time_ms": 16787.119, "sample_time_ms": 9408.144, "load_time_ms": 0.451, "load_throughput": 8868856.584, "learn_time_ms": 7370.859, "learn_throughput": 542.678, "synch_weights_time_ms": 7.084}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 640, "training_iteration": 16, "trial_id": "default", "date": "2024-05-19_00-32-28", "timestamp": 1716103948, "time_this_iter_s": 16.658688068389893, "time_total_s": 269.9713976383209, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 269.9713976383209, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.19166666666667, "ram_util_percent": 49.25833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.545267822793735, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.870131923306374, "policy_loss": -0.04564644366012065, "vf_loss": 19.91307074434014, "vf_explained_var": 0.0009726371175499373, "kl": 0.013538255764789404, "entropy": 0.5045164463981505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 1000.0, "episode_reward_min": 914.0, "episode_reward_mean": 957.39, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 946.0, 982.0, 942.0, 958.0, 949.0, 941.0, 980.0, 939.0, 956.0, 940.0, 914.0, 935.0, 968.0, 970.0, 965.0, 926.0, 958.0, 978.0, 948.0, 942.0, 945.0, 956.0, 950.0, 959.0, 992.0, 958.0, 961.0, 940.0, 952.0, 964.0, 980.0, 951.0, 947.0, 954.0, 964.0, 960.0, 922.0, 966.0, 960.0, 958.0, 961.0, 955.0, 958.0, 915.0, 984.0, 964.0, 959.0, 973.0, 966.0, 950.0, 947.0, 949.0, 966.0, 968.0, 962.0, 966.0, 971.0, 977.0, 960.0, 941.0, 921.0, 960.0, 968.0, 944.0, 979.0, 968.0, 980.0, 956.0, 955.0, 971.0, 941.0, 970.0, 942.0, 950.0, 1000.0, 958.0, 944.0, 977.0, 975.0, 949.0, 920.0, 968.0, 958.0, 958.0, 952.0, 977.0, 976.0, 950.0, 935.0, 961.0, 966.0, 979.0, 941.0, 957.0, 977.0, 962.0, 959.0, 966.0, 951.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35175903847597373, "mean_inference_ms": 1.746054253178845, "mean_action_processing_ms": 0.12997889302734536, "mean_env_wait_ms": 0.12154913389363343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022977590560913086, "StateBufferConnector_ms": 0.0052411556243896484, "ViewRequirementAgentConnector_ms": 0.12474298477172852}, "num_episodes": 40, "episode_return_max": 1000.0, "episode_return_min": 914.0, "episode_return_mean": 957.39}, "env_runner_results": {"episode_reward_max": 1000.0, "episode_reward_min": 914.0, "episode_reward_mean": 957.39, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 946.0, 982.0, 942.0, 958.0, 949.0, 941.0, 980.0, 939.0, 956.0, 940.0, 914.0, 935.0, 968.0, 970.0, 965.0, 926.0, 958.0, 978.0, 948.0, 942.0, 945.0, 956.0, 950.0, 959.0, 992.0, 958.0, 961.0, 940.0, 952.0, 964.0, 980.0, 951.0, 947.0, 954.0, 964.0, 960.0, 922.0, 966.0, 960.0, 958.0, 961.0, 955.0, 958.0, 915.0, 984.0, 964.0, 959.0, 973.0, 966.0, 950.0, 947.0, 949.0, 966.0, 968.0, 962.0, 966.0, 971.0, 977.0, 960.0, 941.0, 921.0, 960.0, 968.0, 944.0, 979.0, 968.0, 980.0, 956.0, 955.0, 971.0, 941.0, 970.0, 942.0, 950.0, 1000.0, 958.0, 944.0, 977.0, 975.0, 949.0, 920.0, 968.0, 958.0, 958.0, 952.0, 977.0, 976.0, 950.0, 935.0, 961.0, 966.0, 979.0, 941.0, 957.0, 977.0, 962.0, 959.0, 966.0, 951.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35175903847597373, "mean_inference_ms": 1.746054253178845, "mean_action_processing_ms": 0.12997889302734536, "mean_env_wait_ms": 0.12154913389363343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022977590560913086, "StateBufferConnector_ms": 0.0052411556243896484, "ViewRequirementAgentConnector_ms": 0.12474298477172852}, "num_episodes": 40, "episode_return_max": 1000.0, "episode_return_min": 914.0, "episode_return_mean": 957.39}, "episode_reward_max": 1000.0, "episode_reward_min": 914.0, "episode_reward_mean": 957.39, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [950.0, 946.0, 982.0, 942.0, 958.0, 949.0, 941.0, 980.0, 939.0, 956.0, 940.0, 914.0, 935.0, 968.0, 970.0, 965.0, 926.0, 958.0, 978.0, 948.0, 942.0, 945.0, 956.0, 950.0, 959.0, 992.0, 958.0, 961.0, 940.0, 952.0, 964.0, 980.0, 951.0, 947.0, 954.0, 964.0, 960.0, 922.0, 966.0, 960.0, 958.0, 961.0, 955.0, 958.0, 915.0, 984.0, 964.0, 959.0, 973.0, 966.0, 950.0, 947.0, 949.0, 966.0, 968.0, 962.0, 966.0, 971.0, 977.0, 960.0, 941.0, 921.0, 960.0, 968.0, 944.0, 979.0, 968.0, 980.0, 956.0, 955.0, 971.0, 941.0, 970.0, 942.0, 950.0, 1000.0, 958.0, 944.0, 977.0, 975.0, 949.0, 920.0, 968.0, 958.0, 958.0, 952.0, 977.0, 976.0, 950.0, 935.0, 961.0, 966.0, 979.0, 941.0, 957.0, 977.0, 962.0, 959.0, 966.0, 951.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35175903847597373, "mean_inference_ms": 1.746054253178845, "mean_action_processing_ms": 0.12997889302734536, "mean_env_wait_ms": 0.12154913389363343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022977590560913086, "StateBufferConnector_ms": 0.0052411556243896484, "ViewRequirementAgentConnector_ms": 0.12474298477172852}, "num_episodes": 40, "episode_return_max": 1000.0, "episode_return_min": 914.0, "episode_return_mean": 957.39, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.5167558613897, "num_env_steps_trained_throughput_per_sec": 240.5167558613897, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 16770.588, "restore_workers_time_ms": 0.013, "training_step_time_ms": 16770.546, "sample_time_ms": 9406.545, "load_time_ms": 0.452, "load_throughput": 8855281.326, "learn_time_ms": 7355.766, "learn_throughput": 543.791, "synch_weights_time_ms": 7.198}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 680, "training_iteration": 17, "trial_id": "default", "date": "2024-05-19_00-32-44", "timestamp": 1716103964, "time_this_iter_s": 16.639263153076172, "time_total_s": 286.6106607913971, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 286.6106607913971, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 38.170833333333334, "ram_util_percent": 49.18333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6919017987866556, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.90709551534345, "policy_loss": -0.0468100478652344, "vf_loss": 19.95101252319992, "vf_explained_var": 0.000973775117628036, "kl": 0.01446547521044042, "entropy": 0.4906182471462475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 1000.0, "episode_reward_min": 915.0, "episode_reward_mean": 958.23, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [958.0, 961.0, 955.0, 958.0, 915.0, 984.0, 964.0, 959.0, 973.0, 966.0, 950.0, 947.0, 949.0, 966.0, 968.0, 962.0, 966.0, 971.0, 977.0, 960.0, 941.0, 921.0, 960.0, 968.0, 944.0, 979.0, 968.0, 980.0, 956.0, 955.0, 971.0, 941.0, 970.0, 942.0, 950.0, 1000.0, 958.0, 944.0, 977.0, 975.0, 949.0, 920.0, 968.0, 958.0, 958.0, 952.0, 977.0, 976.0, 950.0, 935.0, 961.0, 966.0, 979.0, 941.0, 957.0, 977.0, 962.0, 959.0, 966.0, 951.0, 959.0, 980.0, 920.0, 972.0, 947.0, 957.0, 957.0, 979.0, 950.0, 964.0, 966.0, 959.0, 962.0, 946.0, 936.0, 976.0, 941.0, 932.0, 962.0, 941.0, 974.0, 967.0, 938.0, 946.0, 929.0, 935.0, 958.0, 980.0, 963.0, 950.0, 970.0, 960.0, 973.0, 972.0, 962.0, 956.0, 933.0, 964.0, 965.0, 951.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35145109471164515, "mean_inference_ms": 1.7443528053355195, "mean_action_processing_ms": 0.12988170371200855, "mean_env_wait_ms": 0.12147460505707766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022988557815551758, "StateBufferConnector_ms": 0.0052149295806884766, "ViewRequirementAgentConnector_ms": 0.12464523315429688}, "num_episodes": 40, "episode_return_max": 1000.0, "episode_return_min": 915.0, "episode_return_mean": 958.23}, "env_runner_results": {"episode_reward_max": 1000.0, "episode_reward_min": 915.0, "episode_reward_mean": 958.23, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [958.0, 961.0, 955.0, 958.0, 915.0, 984.0, 964.0, 959.0, 973.0, 966.0, 950.0, 947.0, 949.0, 966.0, 968.0, 962.0, 966.0, 971.0, 977.0, 960.0, 941.0, 921.0, 960.0, 968.0, 944.0, 979.0, 968.0, 980.0, 956.0, 955.0, 971.0, 941.0, 970.0, 942.0, 950.0, 1000.0, 958.0, 944.0, 977.0, 975.0, 949.0, 920.0, 968.0, 958.0, 958.0, 952.0, 977.0, 976.0, 950.0, 935.0, 961.0, 966.0, 979.0, 941.0, 957.0, 977.0, 962.0, 959.0, 966.0, 951.0, 959.0, 980.0, 920.0, 972.0, 947.0, 957.0, 957.0, 979.0, 950.0, 964.0, 966.0, 959.0, 962.0, 946.0, 936.0, 976.0, 941.0, 932.0, 962.0, 941.0, 974.0, 967.0, 938.0, 946.0, 929.0, 935.0, 958.0, 980.0, 963.0, 950.0, 970.0, 960.0, 973.0, 972.0, 962.0, 956.0, 933.0, 964.0, 965.0, 951.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35145109471164515, "mean_inference_ms": 1.7443528053355195, "mean_action_processing_ms": 0.12988170371200855, "mean_env_wait_ms": 0.12147460505707766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022988557815551758, "StateBufferConnector_ms": 0.0052149295806884766, "ViewRequirementAgentConnector_ms": 0.12464523315429688}, "num_episodes": 40, "episode_return_max": 1000.0, "episode_return_min": 915.0, "episode_return_mean": 958.23}, "episode_reward_max": 1000.0, "episode_reward_min": 915.0, "episode_reward_mean": 958.23, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [958.0, 961.0, 955.0, 958.0, 915.0, 984.0, 964.0, 959.0, 973.0, 966.0, 950.0, 947.0, 949.0, 966.0, 968.0, 962.0, 966.0, 971.0, 977.0, 960.0, 941.0, 921.0, 960.0, 968.0, 944.0, 979.0, 968.0, 980.0, 956.0, 955.0, 971.0, 941.0, 970.0, 942.0, 950.0, 1000.0, 958.0, 944.0, 977.0, 975.0, 949.0, 920.0, 968.0, 958.0, 958.0, 952.0, 977.0, 976.0, 950.0, 935.0, 961.0, 966.0, 979.0, 941.0, 957.0, 977.0, 962.0, 959.0, 966.0, 951.0, 959.0, 980.0, 920.0, 972.0, 947.0, 957.0, 957.0, 979.0, 950.0, 964.0, 966.0, 959.0, 962.0, 946.0, 936.0, 976.0, 941.0, 932.0, 962.0, 941.0, 974.0, 967.0, 938.0, 946.0, 929.0, 935.0, 958.0, 980.0, 963.0, 950.0, 970.0, 960.0, 973.0, 972.0, 962.0, 956.0, 933.0, 964.0, 965.0, 951.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35145109471164515, "mean_inference_ms": 1.7443528053355195, "mean_action_processing_ms": 0.12988170371200855, "mean_env_wait_ms": 0.12147460505707766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022988557815551758, "StateBufferConnector_ms": 0.0052149295806884766, "ViewRequirementAgentConnector_ms": 0.12464523315429688}, "num_episodes": 40, "episode_return_max": 1000.0, "episode_return_min": 915.0, "episode_return_mean": 958.23, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.3555593254526, "num_env_steps_trained_throughput_per_sec": 239.3555593254526, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 16733.134, "restore_workers_time_ms": 0.012, "training_step_time_ms": 16733.095, "sample_time_ms": 9379.059, "load_time_ms": 0.451, "load_throughput": 8868856.584, "learn_time_ms": 7345.798, "learn_throughput": 544.529, "synch_weights_time_ms": 7.2}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 720, "training_iteration": 18, "trial_id": "default", "date": "2024-05-19_00-33-01", "timestamp": 1716103981, "time_this_iter_s": 16.719801902770996, "time_total_s": 303.3304626941681, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 303.3304626941681, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.44166666666666, "ram_util_percent": 49.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.528201759886998, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.841301058697443, "policy_loss": -0.04753802263888941, "vf_loss": 19.885972839273432, "vf_explained_var": 0.001044762198643018, "kl": 0.014331284889051011, "entropy": 0.4842874564470783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 991.0, "episode_reward_min": 920.0, "episode_reward_mean": 956.95, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [949.0, 920.0, 968.0, 958.0, 958.0, 952.0, 977.0, 976.0, 950.0, 935.0, 961.0, 966.0, 979.0, 941.0, 957.0, 977.0, 962.0, 959.0, 966.0, 951.0, 959.0, 980.0, 920.0, 972.0, 947.0, 957.0, 957.0, 979.0, 950.0, 964.0, 966.0, 959.0, 962.0, 946.0, 936.0, 976.0, 941.0, 932.0, 962.0, 941.0, 974.0, 967.0, 938.0, 946.0, 929.0, 935.0, 958.0, 980.0, 963.0, 950.0, 970.0, 960.0, 973.0, 972.0, 962.0, 956.0, 933.0, 964.0, 965.0, 951.0, 976.0, 963.0, 968.0, 951.0, 959.0, 935.0, 952.0, 961.0, 946.0, 946.0, 971.0, 954.0, 928.0, 965.0, 935.0, 955.0, 966.0, 960.0, 945.0, 950.0, 982.0, 955.0, 944.0, 945.0, 961.0, 945.0, 971.0, 966.0, 938.0, 959.0, 965.0, 991.0, 937.0, 965.0, 969.0, 982.0, 933.0, 980.0, 946.0, 961.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3511881155775326, "mean_inference_ms": 1.742792361791877, "mean_action_processing_ms": 0.12979477476004825, "mean_env_wait_ms": 0.12140776147163976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003339767456055, "StateBufferConnector_ms": 0.005266904830932617, "ViewRequirementAgentConnector_ms": 0.12552118301391602}, "num_episodes": 40, "episode_return_max": 991.0, "episode_return_min": 920.0, "episode_return_mean": 956.95}, "env_runner_results": {"episode_reward_max": 991.0, "episode_reward_min": 920.0, "episode_reward_mean": 956.95, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [949.0, 920.0, 968.0, 958.0, 958.0, 952.0, 977.0, 976.0, 950.0, 935.0, 961.0, 966.0, 979.0, 941.0, 957.0, 977.0, 962.0, 959.0, 966.0, 951.0, 959.0, 980.0, 920.0, 972.0, 947.0, 957.0, 957.0, 979.0, 950.0, 964.0, 966.0, 959.0, 962.0, 946.0, 936.0, 976.0, 941.0, 932.0, 962.0, 941.0, 974.0, 967.0, 938.0, 946.0, 929.0, 935.0, 958.0, 980.0, 963.0, 950.0, 970.0, 960.0, 973.0, 972.0, 962.0, 956.0, 933.0, 964.0, 965.0, 951.0, 976.0, 963.0, 968.0, 951.0, 959.0, 935.0, 952.0, 961.0, 946.0, 946.0, 971.0, 954.0, 928.0, 965.0, 935.0, 955.0, 966.0, 960.0, 945.0, 950.0, 982.0, 955.0, 944.0, 945.0, 961.0, 945.0, 971.0, 966.0, 938.0, 959.0, 965.0, 991.0, 937.0, 965.0, 969.0, 982.0, 933.0, 980.0, 946.0, 961.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3511881155775326, "mean_inference_ms": 1.742792361791877, "mean_action_processing_ms": 0.12979477476004825, "mean_env_wait_ms": 0.12140776147163976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003339767456055, "StateBufferConnector_ms": 0.005266904830932617, "ViewRequirementAgentConnector_ms": 0.12552118301391602}, "num_episodes": 40, "episode_return_max": 991.0, "episode_return_min": 920.0, "episode_return_mean": 956.95}, "episode_reward_max": 991.0, "episode_reward_min": 920.0, "episode_reward_mean": 956.95, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [949.0, 920.0, 968.0, 958.0, 958.0, 952.0, 977.0, 976.0, 950.0, 935.0, 961.0, 966.0, 979.0, 941.0, 957.0, 977.0, 962.0, 959.0, 966.0, 951.0, 959.0, 980.0, 920.0, 972.0, 947.0, 957.0, 957.0, 979.0, 950.0, 964.0, 966.0, 959.0, 962.0, 946.0, 936.0, 976.0, 941.0, 932.0, 962.0, 941.0, 974.0, 967.0, 938.0, 946.0, 929.0, 935.0, 958.0, 980.0, 963.0, 950.0, 970.0, 960.0, 973.0, 972.0, 962.0, 956.0, 933.0, 964.0, 965.0, 951.0, 976.0, 963.0, 968.0, 951.0, 959.0, 935.0, 952.0, 961.0, 946.0, 946.0, 971.0, 954.0, 928.0, 965.0, 935.0, 955.0, 966.0, 960.0, 945.0, 950.0, 982.0, 955.0, 944.0, 945.0, 961.0, 945.0, 971.0, 966.0, 938.0, 959.0, 965.0, 991.0, 937.0, 965.0, 969.0, 982.0, 933.0, 980.0, 946.0, 961.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3511881155775326, "mean_inference_ms": 1.742792361791877, "mean_action_processing_ms": 0.12979477476004825, "mean_env_wait_ms": 0.12140776147163976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003339767456055, "StateBufferConnector_ms": 0.005266904830932617, "ViewRequirementAgentConnector_ms": 0.12552118301391602}, "num_episodes": 40, "episode_return_max": 991.0, "episode_return_min": 920.0, "episode_return_mean": 956.95, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.94753344491173, "num_env_steps_trained_throughput_per_sec": 239.94753344491173, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 16722.079, "restore_workers_time_ms": 0.012, "training_step_time_ms": 16722.039, "sample_time_ms": 9378.44, "load_time_ms": 0.451, "load_throughput": 8868856.584, "learn_time_ms": 7335.464, "learn_throughput": 545.296, "synch_weights_time_ms": 7.084}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 760, "training_iteration": 19, "trial_id": "default", "date": "2024-05-19_00-33-18", "timestamp": 1716103998, "time_this_iter_s": 16.678282022476196, "time_total_s": 320.0087447166443, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 320.0087447166443, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 37.721739130434784, "ram_util_percent": 49.34347826086957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7861172824777585, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 19.841987866227345, "policy_loss": -0.04687564559381015, "vf_loss": 19.886093309874177, "vf_explained_var": 0.0010195632775624594, "kl": 0.013851167421107322, "entropy": 0.4736393040867262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 991.0, "episode_reward_min": 926.0, "episode_reward_mean": 959.25, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [974.0, 967.0, 938.0, 946.0, 929.0, 935.0, 958.0, 980.0, 963.0, 950.0, 970.0, 960.0, 973.0, 972.0, 962.0, 956.0, 933.0, 964.0, 965.0, 951.0, 976.0, 963.0, 968.0, 951.0, 959.0, 935.0, 952.0, 961.0, 946.0, 946.0, 971.0, 954.0, 928.0, 965.0, 935.0, 955.0, 966.0, 960.0, 945.0, 950.0, 982.0, 955.0, 944.0, 945.0, 961.0, 945.0, 971.0, 966.0, 938.0, 959.0, 965.0, 991.0, 937.0, 965.0, 969.0, 982.0, 933.0, 980.0, 946.0, 961.0, 976.0, 967.0, 954.0, 965.0, 950.0, 964.0, 990.0, 946.0, 949.0, 973.0, 967.0, 964.0, 978.0, 986.0, 983.0, 960.0, 926.0, 936.0, 962.0, 952.0, 952.0, 958.0, 949.0, 961.0, 956.0, 962.0, 971.0, 964.0, 983.0, 970.0, 982.0, 956.0, 953.0, 979.0, 959.0, 964.0, 974.0, 951.0, 941.0, 965.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3515063783937902, "mean_inference_ms": 1.7448500883191889, "mean_action_processing_ms": 0.13002143381951814, "mean_env_wait_ms": 0.1215028390847922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023931503295898438, "StateBufferConnector_ms": 0.0053975582122802734, "ViewRequirementAgentConnector_ms": 0.12896490097045898}, "num_episodes": 40, "episode_return_max": 991.0, "episode_return_min": 926.0, "episode_return_mean": 959.25}, "env_runner_results": {"episode_reward_max": 991.0, "episode_reward_min": 926.0, "episode_reward_mean": 959.25, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [974.0, 967.0, 938.0, 946.0, 929.0, 935.0, 958.0, 980.0, 963.0, 950.0, 970.0, 960.0, 973.0, 972.0, 962.0, 956.0, 933.0, 964.0, 965.0, 951.0, 976.0, 963.0, 968.0, 951.0, 959.0, 935.0, 952.0, 961.0, 946.0, 946.0, 971.0, 954.0, 928.0, 965.0, 935.0, 955.0, 966.0, 960.0, 945.0, 950.0, 982.0, 955.0, 944.0, 945.0, 961.0, 945.0, 971.0, 966.0, 938.0, 959.0, 965.0, 991.0, 937.0, 965.0, 969.0, 982.0, 933.0, 980.0, 946.0, 961.0, 976.0, 967.0, 954.0, 965.0, 950.0, 964.0, 990.0, 946.0, 949.0, 973.0, 967.0, 964.0, 978.0, 986.0, 983.0, 960.0, 926.0, 936.0, 962.0, 952.0, 952.0, 958.0, 949.0, 961.0, 956.0, 962.0, 971.0, 964.0, 983.0, 970.0, 982.0, 956.0, 953.0, 979.0, 959.0, 964.0, 974.0, 951.0, 941.0, 965.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3515063783937902, "mean_inference_ms": 1.7448500883191889, "mean_action_processing_ms": 0.13002143381951814, "mean_env_wait_ms": 0.1215028390847922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023931503295898438, "StateBufferConnector_ms": 0.0053975582122802734, "ViewRequirementAgentConnector_ms": 0.12896490097045898}, "num_episodes": 40, "episode_return_max": 991.0, "episode_return_min": 926.0, "episode_return_mean": 959.25}, "episode_reward_max": 991.0, "episode_reward_min": 926.0, "episode_reward_mean": 959.25, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [974.0, 967.0, 938.0, 946.0, 929.0, 935.0, 958.0, 980.0, 963.0, 950.0, 970.0, 960.0, 973.0, 972.0, 962.0, 956.0, 933.0, 964.0, 965.0, 951.0, 976.0, 963.0, 968.0, 951.0, 959.0, 935.0, 952.0, 961.0, 946.0, 946.0, 971.0, 954.0, 928.0, 965.0, 935.0, 955.0, 966.0, 960.0, 945.0, 950.0, 982.0, 955.0, 944.0, 945.0, 961.0, 945.0, 971.0, 966.0, 938.0, 959.0, 965.0, 991.0, 937.0, 965.0, 969.0, 982.0, 933.0, 980.0, 946.0, 961.0, 976.0, 967.0, 954.0, 965.0, 950.0, 964.0, 990.0, 946.0, 949.0, 973.0, 967.0, 964.0, 978.0, 986.0, 983.0, 960.0, 926.0, 936.0, 962.0, 952.0, 952.0, 958.0, 949.0, 961.0, 956.0, 962.0, 971.0, 964.0, 983.0, 970.0, 982.0, 956.0, 953.0, 979.0, 959.0, 964.0, 974.0, 951.0, 941.0, 965.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3515063783937902, "mean_inference_ms": 1.7448500883191889, "mean_action_processing_ms": 0.13002143381951814, "mean_env_wait_ms": 0.1215028390847922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023931503295898438, "StateBufferConnector_ms": 0.0053975582122802734, "ViewRequirementAgentConnector_ms": 0.12896490097045898}, "num_episodes": 40, "episode_return_max": 991.0, "episode_return_min": 926.0, "episode_return_mean": 959.25, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.3953163900392, "num_env_steps_trained_throughput_per_sec": 218.3953163900392, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 16890.415, "restore_workers_time_ms": 0.012, "training_step_time_ms": 16890.375, "sample_time_ms": 9467.773, "load_time_ms": 0.451, "load_throughput": 8862297.818, "learn_time_ms": 7414.358, "learn_throughput": 539.494, "synch_weights_time_ms": 7.194}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 800, "training_iteration": 20, "trial_id": "default", "date": "2024-05-19_00-33-36", "timestamp": 1716104016, "time_this_iter_s": 18.323775053024292, "time_total_s": 338.3325197696686, "pid": 2149, "hostname": "Sohams-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c71afc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 338.3325197696686, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 42.08888888888888, "ram_util_percent": 48.914814814814825}}
